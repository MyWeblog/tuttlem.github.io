---
layout: post
title: A C# Micro-framework
date: 2012-12-14
comments: false
---

<h1>{{ page.title }}</h1>
<div class='post'>
<h3>Introduction</h3><div>For a long time now, I've been creating web sites using Visual Studio, ASP.NET and C# for a living. It's a rewarding experience at times and at other times it's a frustrating mess of boilerplate, project files, sluggish compile times and all things horrible that impact the logical side of my brain.</div><div><br /></div><div>What I would like to try in this article is to put forward an idea as well as some prototype code that will help us all establish a good footing in the micro-framework arena for ASP.NET. There are some key focus-points that are negatives, but I'll use this list to establish a clear set of goals that I want this software/framework to solve. &nbsp;</div><div><br /></div><div>If you've ever used micro-frameworks to the like of <a href="http://www.sinatrarb.com/">Sinatra</a>, <a href="http://flask.pocoo.org/">Flask</a>&nbsp;or&nbsp;<a href="http://camping.io/">Camping</a>&nbsp;before it should be coming pretty clear where I'm heading in this post.</div><div><br /></div><h3>Why the Negativity?</h3><div>Well, I don't think I'm being negative - I just think that there are some attributes of ASP.NET programming that could be improved from the developers perspective to make them more productive. Take out all the guff and crud of setting up web applications, projects, routing, <b><u>AHHHHH!!! STOP!</u></b></div><div><b><u><br /></u></b></div><div>I can still hear the echoes of peoples' voices rattling around in my head about how we were so much more productive back in the ASP days and how .NET has slowed down the production of software. My boss may be unique with his point of view or this may be a common point of view. As developers we know that we have gained a hell-of-a-lot since the dark days of ASP development.&nbsp;</div><div><br /></div><div>Unfortunately, this doesn't equate to being more productive in the eyes of the not-so-technical, and it's true - we're not delivering software with the same velocity as we once were -- this is a whole blog post of its own with pro's and con's -- not today.</div><div><br /></div><h3>First stop: Tools</h3><div>If we're going to make this work for us, we're going to need some tools. The frameworks that I've mentioned above are all based on interpreted languages. Languages that benefit from <a href="http://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop">REPL</a> environments. So, I made a C# console application that:</div><div><ol><li>Scans the directory that it was invoked in for changes in C# files</li><li>Compiles these changes on the fly into an in-memory assembly</li><li>Serves the functions defined in this assembly as web pages</li></ol><div>It's very much so a poor man's MVC at the moment, but this isn't a failing of the idea it's a failing of only having a couple of hours to look at this problem last night.&nbsp;</div></div><div><br /></div><div>So this application, this console too, I have called "Dino".</div><div><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-1FktvoqDSos/UMqIjV2n1SI/AAAAAAAAAi0/VAcNOXu7sqQ/s1600/hello.gif" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="267" src="http://4.bp.blogspot.com/-1FktvoqDSos/UMqIjV2n1SI/AAAAAAAAAi0/VAcNOXu7sqQ/s400/hello.gif" width="400" /></a></div><div><br /></div><div>There's Dino, running in the bottom left-hand corner of the screen. Quietly re-compling changes on the fly that it detects in the C# file loaded into note pad on the right hand and serving the results of Temp.Hello() as an execution into the web browser on the left.</div><div><br /></div><div>For simplicity, I re-directed standard output for these assemblies to talk to the web socket so that I could just use <a href="http://msdn.microsoft.com/en-us/library/system.console.write.aspx">Console.Write</a>&nbsp;to send data back to the client.</div><div><br /></div><div>Here's some more work:</div><div><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-R8QH_gBXNFo/UMqJOChUknI/AAAAAAAAAi8/dd6wyzG2OC4/s1600/hello-2.gif" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="268" src="http://2.bp.blogspot.com/-R8QH_gBXNFo/UMqJOChUknI/AAAAAAAAAi8/dd6wyzG2OC4/s400/hello-2.gif" width="400" /></a></div><div><br /></div><div>To show that this is a dynamic environment, Temp.cs just had a Goodbye and Clock method added to it. You can see that in chrome I'm calling the Clock method.</div><div><br /></div><div>Finally:</div><div><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-i3WUd1nsvgc/UMqJdNoWWDI/AAAAAAAAAjE/wnJxDDE8Bkw/s1600/run-forest.gif" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="268" src="http://4.bp.blogspot.com/-i3WUd1nsvgc/UMqJdNoWWDI/AAAAAAAAAjE/wnJxDDE8Bkw/s400/run-forest.gif" width="400" /></a></div><div><br /></div><div>I just dropped a new file "Temp2.cs" into the folder with a method called "Run". You can see that chrome is now&nbsp;targeting&nbsp;Temp2 rather than Temp in the previous screenshots.</div><div><br /></div><div><br /></div><div>Ok, great. We've got the programmer focused on what's important. Just filling these methods out with implementation that matters! Feeling productive already albeit in a very minimalistic way.</div><div><br /></div><h3>Next Steps</h3><div>Right. As I said above, this is very early days and I haven't had much time to spend doing the implementation. It could turn into something very productive (doing actual useful things) rather quickly. Some pieces that immediately come to mind that I'd like to see are:</div><div><ul><li>Changing the standard output pipe to a more friendly http response object</li><li>Providing a http request object for access to query strings, form variables, cookies, etc</li><li>or .. rather providing these details as parameters to this method (much like ASP.NET MVC)</li><li>Flexible attribute-based routing</li><li>A templating system (did I hear you say razor?)</li><li>A deployment strategy: perhaps a http module that would host this style of application so that it can be a fully blown IIS application in production?</li><li>Automatically running unit-tests after automatic compilations?</li></ul></div>You can see here that a lot of this has already been implemented by existing technologies right out of the .NET toolbox. The whole ASP.NET http request/response pair do a great job in facilitating this communication and the MVC framework also gives you flexible routing and a really nice templating framework. If I could find a way to mix these in, we'd just about be on a winner here.<br /><br />I will put Dino up in my <a href="https://github.com/tuttlem">github&nbsp;repository</a>&nbsp;shortly. There's a few preliminary things I'd like to take care of first before I commit it in.<br /><br />I'll keep you posted!</div>
<h2>Comments</h2>
<div class='comments'>
</div>
