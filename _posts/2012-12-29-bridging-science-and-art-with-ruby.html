---
layout: post
title: Bridging Science and Art with Ruby
date: 2012-12-29
comments: false
---

<h1>{{ page.title }}</h1>
<div class='post'>
<h3>Introduction</h3><div>Having a love for music and technology at the same time can be a dangerous business. You can really fool yourself into thinking that you can boil art down into algebraic or procedural recipes that you can just turn the handle on. The frustration sets in when it's just not that black-and-white.</div><div><br /></div><div>In this post, I've put some Ruby code together that takes in an array of <a href="http://en.wikipedia.org/wiki/Interval_(music)">musical intervals</a>&nbsp;and attempts to give that array of intervals a name. In music, this is better known as a <a href="http://en.wikipedia.org/wiki/Chord_(music)">chord</a>&nbsp;or <a href="http://en.wikipedia.org/wiki/Arpeggio">arpeggio</a>.&nbsp;</div><div><br /></div><h3>Assumptions</h3><div>As above, I want an array of intervals in so this is going to take shape in the form of an integer array. These integers will be the individual distances (in semi-tones) from the root which will start at 0. For reference, here's a chart that I used during development.</div><div><br /><table><tbody><tr><th>First Octave</th><th>Second Octave</th><th>Interval Names</th></tr><tr><td><span style="color: red;">0</span></td><td><span style="color: red;">12</span></td><td>Root/Unison</td></tr><tr><td>1</td><td>13</td><td>Minor Second/Flat Nine</td></tr><tr><td>2</td><td>14</td><td>Major Second/Nine</td></tr><tr><td>3</td><td><span style="color: red;">15</span></td><td>Minor Third</td></tr><tr><td>4</td><td><span style="color: red;">16</span></td><td>Major Third</td></tr><tr><td>5</td><td>17</td><td>Perfect Fourth/Eleventh</td></tr><tr><td>6</td><td>18</td><td>Tritone/Sharp Eleven</td></tr><tr><td>7</td><td><span style="color: red;">19</span></td><td>Perfect Fifth</td></tr><tr><td>8</td><td>20</td><td>Minor Sixth/Flat Thirteen</td></tr><tr><td>9</td><td>21</td><td>Major Sixth/Thirteenth</td></tr><tr><td>10</td><td><span style="color: red;">22</span></td><td>Minor Seventh</td></tr><tr><td>11</td><td><span style="color: red;">23</span></td><td>Major Seventh</td></tr></tbody></table></div><div><br />Intervals that are coloured red, didn't really factor into the overall solution as they add nothing to the chord's quality or extension. Well, this may not be entirely true, some jazz-heads have probably already got their cross-hairs locked onto me, ready to flame away.<br /><br /><h3>Gathering facts</h3></div><div>First of all, we need the array of intervals into our class. We'll always assume that there is a root and if there isn't one, we'll pop one into the array for good measure.</div><div><br /><script src="https://gist.github.com/4406523.js"></script></div><div><br /></div><div><br /></div><div>We're now managing an array of intervals. What we need to do is ask questions of that array so we can gather information about our chord. The following methods ask the important questions in the first octave.<br /><br /><script src="https://gist.github.com/4406546.js"></script> <br />With just this base information we can find a lot out about the chord, but it's not nearly enough. We need to be sure. The best part about putting these basic building blocks in place is that our methods are going to read a little more human from now on. Here are some more fact finders.<br /><br /><script src="https://gist.github.com/4406556.js"></script> <br />Finally we have a couple more tests that we need to conduct on the array in the upper octave, otherwise none of the jazz-guys are going to get their chords! These again will form syntactic sugar for the main feature, to_s.<br /><br /><script src="https://gist.github.com/4406565.js"></script> <br /><br /><h3>Piecing it together</h3></div><div>It's good that we know so much about our chord. It means that we can ask questions and make decisions based on the outcomes of these questions. Upon reflection, I did have another idea on assembling those fact-finding methods into a more flexible but highly-unhuman set of methods that when you asked about a particular interval, you'd get back either :flat, :natural or :sharp. Perhaps I'll try it in another revision; I digress.</div><div><br /></div><div>All the facts are in front of us, let's construct a string from these facts. Now here's where the awkward bridge between science and art starts to burn a little, then a lot. Questions must not only be asked of the array, but they have to be asked in the right order otherwise you'll get a different result.</div><div><br /></div><div>That's naming for you though. It doesn't read pretty, but here it is.</div><div><br /><script src="https://gist.github.com/4406569.js"></script></div><div><br /></div><div><br /></div><div>Woosh. That was a lot of if-treeing. There has to be a better way of doing this, but by my calculations using this code I've covered the following use-cases off:<br /><br /><br /><ul><li>Major</li><li>Minor</li><li>Diminished</li><li>Diminished Seventh</li><li>Augmented</li><li>Seventh</li><li>Minor Seventh</li><li>Major Seventh</li><li>Suspended Second</li><li>Suspended Fourth</li><li>Seventh Flat 5</li><li>Seventh Sharp 5</li><li>Major Seventh Flat 5</li><li>Major Seventh Sharp 5</li><li>Minor Seventh Flat 5</li><li>Minor Seventh Sharp 5</li><li>Ninth</li><li>Eleventh</li><li>Thirteenth</li></ul><div>There's a few chords there, but there are just so many more and this code may work for them. Those other cases just haven't made it into my unit tests yet.</div><div><br /></div><h3>Plans</h3><div>I really want to make this part of a bigger application that I'm writing at the moment. I was motivated to write a unit like this because I didn't want chord definitions just sitting in a database, I wanted the application to do the think work. Possibilities from here also reach into inversions and slash chords. It would be easy to permute the list of intervals and enumerate all of the inversion scenarios.</div><div><br /></div><div>Anyway, until next time!</div></div></div>
<h2>Comments</h2>
<div class='comments'>
</div>
