<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Cogs and Levers &middot; A blog full of technical stuff
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>A place for thoughts, ideas, tutorials and bookmarks. My brain can only hold so much, you know.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    

    
    
      
        
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    

    <a class="sidebar-nav-item" href="https://github.com/tuttlem/tuttlem.github.io">GitHub</a>
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2014. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <label for="sidebar-checkbox" class="sidebar-toggle"></label>

          <h3 class="masthead-title">
            <a href="/" title="Home">Cogs and Levers</a>
            <small>A blog full of technical stuff</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2012/12/03/sdl-you-can-use-part-4/">
        SDL you can use (part 4)
      </a>
    </h1>

    <span class="post-date">03 Dec 2012</span>

    <h1>SDL you can use (part 4)</h1>
<div class='post'>
<h3>Introduction</h3><div>The audio of a game/demo/application can be a maker or breaker. You can really set the mood of your game with the right sound effects and music.</div><div><br /></div><div>This tutorial, I'll walk you through setting up the audio system, loading some sound bytes, playing them and the cleaning up. You'll need to have <a href="http://www.libsdl.org/projects/SDL_mixer/">SDL_mixer</a> installed. Make sure that's installed and continue on!</div><div><br /></div><div>Lets just jump straight in.<br /><br /></div><h3>Setup</h3><br />Issuing a call to <a href="http://www.libsdl.org/projects/SDL_mixer/docs/SDL_mixer_11.html">Mix_OpenAudio</a>&nbsp;is all that's needed to initialize the audio system. It's as simple as this:<br /><br /><script src="https://gist.github.com/4194246.js?file=gistfile1.c"></script> <br /><br />From here you can load both music files and sound files. There is a difference. Music will run in the background where as sound effects will be one-shot deals. You'll need to use <a href="http://www.libsdl.org/projects/SDL_mixer/docs/SDL_mixer_55.html#SEC55">Mix_LoadMUS</a>&nbsp;to load a music file and <a href="http://www.libsdl.org/projects/SDL_mixer/docs/SDL_mixer_19.html#SEC19">Mix_LoadWAV</a>&nbsp;to load a sound file.<br /><br /><script src="https://gist.github.com/4194302.js?file=gistfile1.c"></script> <br /><br /><h3>Playing&nbsp;</h3><div>You can play a sound effect on a particular channel (or all channels) using <a href="http://www.libsdl.org/projects/SDL_mixer/docs/SDL_mixer_28.html#SEC28">Mix_PlayChannel</a>&nbsp;or start and stop music in the background using <a href="http://www.libsdl.org/projects/SDL_mixer/docs/SDL_mixer_57.html#SEC57">Mix_PlayMusic</a>&nbsp;and <a href="http://www.libsdl.org/projects/SDL_mixer/docs/SDL_mixer_62.html#SEC62">Mix_PauseMusic</a>.&nbsp;</div><div><br /><script src="https://gist.github.com/4194363.js?file=gistfile1.c"></script></div><div><br /></div><div><br /></div><div><h3>Cleaning up</h3></div><div>It's just common courtesy to free all of the resources that you allocate, so the following functions will allow you to deallocate sounds, music files and the audio system.</div><div><br /><script src="https://gist.github.com/4194395.js?file=gistfile1.c"></script></div><div><br /></div><div><br /></div><div>Well, that's about it.</div></div>
<h2>Comments</h2>
<div class='comments'>
</div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2012/12/03/sdl-you-can-use-part-3/">
        SDL you can use (part 3)
      </a>
    </h1>

    <span class="post-date">03 Dec 2012</span>

    <h1>SDL you can use (part 3)</h1>
<div class='post'>
<h3>Introduction</h3><div>Setting up a window using the SDL framework is quite a trivial task. Attaching a message loop to the application is also rather easy and I take you through that in <a href="http://cogsandlevers.blogspot.com.au/2012/12/sdl-you-can-use-part-2.html">this</a> previous article.</div><div><br /></div><div>This article will set you up ready to load in your <a href="http://www.opengl.org/">OpenGL</a> functionality. I think it's important to make clear that this is not going to be a tutorial on&nbsp;<a href="http://www.opengl.org/">OpenGL</a>, rather it'll be a tutorial on how to get to using it. If you are interested in some in-depth&nbsp;<a href="http://www.opengl.org/">OpenGL</a>&nbsp;topics, I suggest you read the <a href="http://nehe.gamedev.net/">tutorials from NeHe</a>&nbsp;- there's quite an extensive set of articles over there.</div><div><br /></div><div>Anyway, onto the code!</div><div><br /></div><h3>Setting the video mode (correctly)</h3><div>Doing some analysis of the <a href="http://www.libsdl.org/docs/html/sdlsetvideomode.html">SDL_SetVideoMode</a>&nbsp;function, the last parameter is going to be of most interest to us. Quoted from the API documentation:</div><div><br /></div><div><table border="1" class="CALSTABLE"><tbody><tr><td align="LEFT" valign="TOP"><tt class="LITERAL" >SDL_SWSURFACE</tt></td><td align="LEFT" valign="TOP"><span >Create the video surface in system memory</span></td></tr><tr><td align="LEFT" valign="TOP"><tt class="LITERAL" >SDL_HWSURFACE</tt></td><td align="LEFT" valign="TOP"><span >Create the video surface in video memory</span></td></tr><tr><td align="LEFT" valign="TOP"><tt class="LITERAL" >SDL_ASYNCBLIT</tt></td><td align="LEFT" valign="TOP"><span >Enables the use of asynchronous updates of the display surface. This will usually slow down blitting on single CPU machines, but may provide a speed increase on SMP systems.</span></td></tr><tr><td align="LEFT" valign="TOP"><tt class="LITERAL" >SDL_ANYFORMAT</tt></td><td align="LEFT" valign="TOP"><span >Normally, if a video surface of the requested bits-per-pixel (<tt class="PARAMETER"><i>bpp</i></tt>) is not available, SDL will emulate one with a shadow surface. Passing&nbsp;<tt class="LITERAL">SDL_ANYFORMAT</tt>&nbsp;prevents this and causes SDL to use the video surface, regardless of its pixel depth.</span></td></tr><tr><td align="LEFT" valign="TOP"><tt class="LITERAL" >SDL_HWPALETTE</tt></td><td align="LEFT" valign="TOP"><span >Give SDL exclusive palette access. Without this flag you may not always get the the colors you request with&nbsp;<a href="http://www.libsdl.org/docs/html/sdlsetcolors.html"><tt class="FUNCTION">SDL_SetColors</tt></a>&nbsp;or&nbsp;<a href="http://www.libsdl.org/docs/html/sdlsetpalette.html"><tt class="FUNCTION">SDL_SetPalette</tt></a>.</span></td></tr><tr><td align="LEFT" valign="TOP"><tt class="LITERAL" >SDL_DOUBLEBUF</tt></td><td align="LEFT" valign="TOP"><span >Enable hardware double buffering; only valid with SDL_HWSURFACE. Calling&nbsp;<a href="http://www.libsdl.org/docs/html/sdlflip.html"><tt class="FUNCTION">SDL_Flip</tt></a>&nbsp;will flip the buffers and update the screen. All drawing will take place on the surface that is not displayed at the moment. If double buffering could not be enabled then&nbsp;<tt class="FUNCTION">SDL_Flip</tt>&nbsp;will just perform a&nbsp;<a href="http://www.libsdl.org/docs/html/sdlupdaterect.html"><tt class="FUNCTION">SDL_UpdateRect</tt></a>&nbsp;on the entire screen.</span></td></tr><tr><td align="LEFT" valign="TOP"><tt class="LITERAL" >SDL_FULLSCREEN</tt></td><td align="LEFT" valign="TOP"><span >SDL will attempt to use a fullscreen mode. If a hardware resolution change is not possible (for whatever reason), the next higher resolution will be used and the display window centered on a black background.</span></td></tr><tr><td align="LEFT" valign="TOP"><tt class="LITERAL" >SDL_OPENGL</tt></td><td align="LEFT" valign="TOP"><span >Create an OpenGL rendering context. You should have previously set OpenGL video attributes with&nbsp;<a href="http://www.libsdl.org/docs/html/sdlglsetattribute.html"><tt class="FUNCTION">SDL_GL_SetAttribute</tt></a>.</span></td></tr><tr><td align="LEFT" valign="TOP"><tt class="LITERAL" >SDL_OPENGLBLIT</tt></td><td align="LEFT" valign="TOP"><span >Create an OpenGL rendering context, like above, but allow normal blitting operations. The screen (2D) surface may have an alpha channel, and&nbsp;<a href="http://www.libsdl.org/docs/html/sdlupdaterects.html"><tt class="FUNCTION">SDL_UpdateRects</tt></a>&nbsp;must be used for updating changes to the screen surface. NOTE: This option is kept for compatibility only, and is&nbsp;<span class="emphasis"><i class="EMPHASIS">not</i></span>&nbsp;recommended for new code.</span></td></tr><tr><td align="LEFT" valign="TOP"><tt class="LITERAL" >SDL_RESIZABLE</tt></td><td align="LEFT" valign="TOP"><span >Create a resizable window. When the window is resized by the user a&nbsp;<a href="http://www.libsdl.org/docs/html/sdlresizeevent.html"><tt class="LITERAL">SDL_VIDEORESIZE</tt></a>&nbsp;event is generated and&nbsp;<tt class="FUNCTION">SDL_SetVideoMode</tt>&nbsp;can be called again with the new size.</span></td></tr><tr><td align="LEFT" valign="TOP"><tt class="LITERAL" >SDL_NOFRAME</tt></td><td align="LEFT" valign="TOP"><span >If possible,&nbsp;<tt class="LITERAL">SDL_NOFRAME</tt>&nbsp;causes SDL to create a window with no title bar or frame decoration. Fullscreen modes automatically have this flag set.</span></td></tr></tbody></table><br /><br />So, it's in our best interest to ensure that we set the video mode with SDL_HWSURFACE, SDL_DOUBLEBUF and SDL_OPENGL (optionally SDL_FULLSCREEN if we don't want to be windowed).<br /><br />Changing our startup code into this<br /><br /><script src="https://gist.github.com/4194156.js?file=gistfile1.c"></script> <br /><br />As long as all goes well, you'll be issuing OpenGL commands against your application, so don't forget to include your GL headers in your application.<br /><br /></div></div>
<h2>Comments</h2>
<div class='comments'>
</div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2012/12/03/sdl-you-can-use-part-2/">
        SDL you can use (part 2)
      </a>
    </h1>

    <span class="post-date">03 Dec 2012</span>

    <h1>SDL you can use (part 2)</h1>
<div class='post'>
<h3>Introduction</h3>In a <a href="http://cogsandlevers.blogspot.com.au/2012/12/sdl-you-can-use-part-1.html">previous post</a>, we had put together a simple build system and we have a window displaying the screen for a short moment - then we're done.<br /><br />Today, we're going to change that fixed delay that the window shows for and make it&nbsp;dependent&nbsp;on when the user wants to quit the application. To do this, I'll be introducing the concept of SDL events.<br /><br />As we're doing this, I'll be able to show you other purposes (or other events) that SDL's eventing system has to offer.<br /><h3>Events and Eventing</h3><div>Events are SDL's way of sending information between the operating system and your application. The SDL library site has a <a href="http://www.libsdl.org/intro.en/usingevents.html">short and concise write-up</a> about their events system. &nbsp;All of the events available can be found <a href="http://www.libsdl.org/docs/html/eventstructures.html">here</a>. Reading over this list should give you a pretty good idea of what information is supported when using SDL. You'll receive information for:</div><div><ul><li>When the application activates</li><li>When you receive keyboard input</li><li>When the mouse is actioned</li><li>When the joystick is actioned</li><li>When the application's window is resized</li><li>When platform dependent information is sent</li><li>When the application requests to quit.</li></ul><div>There isn't much out of list that we won't need. If we do get stuck, we always have <a href="http://www.libsdl.org/docs/html/sdluserevent.html">SDL_UserEvent</a>&nbsp;available to us to send custom information.</div></div><h3>What's it look like?</h3><div>Now that all of the wordy stuff is out of the way, it's time to show you how to put one of these message loops together. That's just it though, it's just a very simple little loop. I've commented this code pretty well so it shouldn't need too much explanation. This code should come directly after your window's (video's) successful creation.</div><div><br /><script src="https://gist.github.com/4191175.js?file=gistfile1.c"></script></div><div><br /></div><div><br /></div><div>The user will now be able to control to lifespan of the application by issuing a quit request to the application. That's much better than just keeping it open for 2 seconds, then quitting.<br /><h3>That's it!</h3></div><div>So, we're still not doing anything uber-exciting. That will come though. We have a few sibling topics to cover now that we've established an application-host (window + event loop). We've got audio, input, network, openGL!</div><div><br /></div></div>
<h2>Comments</h2>
<div class='comments'>
</div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2012/12/02/simple-fpu-operations/">
        Simple FPU Operations
      </a>
    </h1>

    <span class="post-date">02 Dec 2012</span>

    <h1>Simple FPU Operations</h1>
<div class='post'>
The CPU itself is an impressive piece of kit just by itself however it does struggle to do complex floating point mathematics. Chip designers noticed this deficiency pretty quickly and bolted on a floating-point arithmetic unit.<br /><br />It should be noted at this point that many, many other tutorial/article writers have gone into great depth explaining how to program FPU's and they have been great references to me in previous times:<br /><br /><a href="http://www.website.masmforum.com/tutorials/fptute/">Simply FPU</a><br /><br /><a href="http://qlibdos32.sourceforge.net/tutor/tutor-fpu.php">80387+ Coprocessor Programming</a><br /><br /><a href="http://www.intel.com/content/www/us/en/processors/architectures-software-developer-manuals.html">Intel Manuals</a><br /><br />Anyway, this blog post is just going to show you a few nuggets that you can use straight away. It's always fun seeing this stuff in action.<br /><br />This snippet will sum (accumulate) together an array of doubles.<br /><br /><br /><script src="https://gist.github.com/4188241.js?file=gistfile1.asm"></script> <br />This following snippet will show you a simple addition, subtraction, multiplication and division. You'll notice a pretty distinct pattern in what to do in these situations. It'll follow:<br /><br /><ul><li>Load the first term (fld)</li><li>Apply the operator (fadd,fsub,fmul,fdiv) with the second term</li><li>Store the result into memory</li></ul><div><br /><script src="https://gist.github.com/4188267.js?file=gistfile1.asm"></script> <br />With a bit of extra help from the C library, you can print out values that you're using in the FPU. The following snippet prints PI to the console.<br /><br /><script src="https://gist.github.com/4198408.js?file=gistfile1.asm"></script><br /><br /></div><div>As I find other snippets in old pieces of code, I'll be sure to add them to this page.</div></div>
<h2>Comments</h2>
<div class='comments'>
</div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2012/12/02/sdl-you-can-use-part-1/">
        SDL you can use (part 1)
      </a>
    </h1>

    <span class="post-date">02 Dec 2012</span>

    <h1>SDL you can use (part 1)</h1>
<div class='post'>
<h3>Introduction</h3><a href="http://www.libsdl.org/">Simple DirectMedia Layer</a>&nbsp;is a cross-platform library aimed at providing all the fun stuff (video, audio, input, etc) so that you can build fantastic <strike>games</strike>&nbsp;<strike>demos</strike> applications.<br /><br />This is a series of tutorials that will get you up and running in a very short time.<br /><br />These tutorials do assume that you've installed SDL and your installation is working without hassle. Being that we are dealing with a cross-platform library, I'll attempt to be as platform agnostic as possible. I will be writing these tutorials from my MacBook Pro though.<br /><br />If you aren't quite at the stage where you can start coding, I'd suggest you run through some of the instructions around on the web. <a href="http://lazyfoo.net/SDL_tutorials/lesson01/index.php">Lazy Foo</a>&nbsp;has done a lot of the work here providing installation instructions for specific platforms.<br /><br />A final introductory note is that I'll be using the GNU toolchain to conduct these tutorials.<br /><br />Anyway, let's get a build environment up and running and then a window showing to screen.<br /><br /><h3>The build environment</h3><div>Making a scenario where you rebuild your application over and over quickly and painlessly increases the enjoyment of the development process, I find.&nbsp;</div><div><br /></div><div>Here's a simple Makefile that you can use for any simple SDL project that you might have. I'll walk you through it.</div><div><br /><script src="https://gist.github.com/4188388.js?file=gistfile1.mak"></script></div><div><br /></div><div><br /></div><div>The rules at the top, specifying switches to the compiler and linker are really doing all of the heavy lifting for the build process. Focusing on <a href="http://koshmaar.linuxpl.info/sdl_config/news.php">sdl-config</a>&nbsp;you can see that we want sdl flags for the compiler and for the linker.<br /><br />On my OSX machine, these commands give me the following output:<br /><br /><pre class="brush:shell;">[michael@zoso] ~ $ sdl-config --cflags<br />-I/usr/local/include/SDL -D_GNU_SOURCE=1 -D_THREAD_SAFE<br />[michael@zoso] ~ $ sdl-config --libs<br />-L/usr/local/lib -lSDLmain -lSDL -Wl,-framework,Cocoa<br /></pre><br /><br />Fantastic. The purpose of these rules is it should make the transporting of this software between machines and platforms a much more portable experience!<br /><br />So, we're still at a false start here. I've given you a Makefile that makes mention of tute0.c, but no source code, so ...<br /><br /><h3>Show me a window for a couple of seconds</h3></div><div>It's a useless example. I really hate it, but I wanted to defer message handling until the next instalment. This one, I just want to show you initialization and termination.</div><div><br /><script src="https://gist.github.com/4188425.js?file=tute0.c"></script></div><div><br /></div><div><br /></div><div><br /></div><div><a href="http://www.libsdl.org/docs/html/sdlinit.html">SDL_Init</a> providing all of the initialization required to be "in the framework". <a href="http://www.libsdl.org/docs/html/sdlsetvideomode.html">SDL_SetVideoMode</a> is quite self explanatory. There will be some different flags that we'll pass to that in later articles that will give us some acceleration (where available). Finally, <a href="http://www.libsdl.org/docs/html/sdlquit.html">SDL_Quit</a> takes us out of the framework, making SDL clean up anything that was left outstanding.<br /><br />A compile and a run ...<br /><br />And for a few fleeting seconds, you're an SDL programmer:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-8pzGZm3W3Ac/ULtJmCtx_7I/AAAAAAAAAig/knahjFWw_HM/s1600/Screen+Shot+2012-12-02+at+10.28.22+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="313" src="http://3.bp.blogspot.com/-8pzGZm3W3Ac/ULtJmCtx_7I/AAAAAAAAAig/knahjFWw_HM/s400/Screen+Shot+2012-12-02+at+10.28.22+PM.png" width="400" /></a></div><br />That's it for this one, nice and simple. We can hit messaging in the next tutorial, just so we can keep the window on screen a bit longer.<br /><br /><br /></div></div>
<h2>Comments</h2>
<div class='comments'>
</div>

  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page36">Older</a>
  
  
    
      <a class="pagination-item newer" href="/page34">Newer</a>
    
  
</div>
      </div>
    </div>

  </body>
</html>
