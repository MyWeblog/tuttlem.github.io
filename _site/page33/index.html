<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Cogs and Levers &middot; A blog full of technical stuff
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>A place for thoughts, ideas, tutorials and bookmarks. My brain can only hold so much, you know.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    

    
    
      
        
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    

    <a class="sidebar-nav-item" href="https://github.com/tuttlem/tuttlem.github.io">GitHub</a>
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2014. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <label for="sidebar-checkbox" class="sidebar-toggle"></label>

          <h3 class="masthead-title">
            <a href="/" title="Home">Cogs and Levers</a>
            <small>A blog full of technical stuff</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2012/12/14/a-c-micro-framework-tool-code/">
        A C Micro Framework Tool Code
      </a>
    </h1>

    <span class="post-date">14 Dec 2012</span>

    <h1>A C Micro Framework Tool Code</h1>
<div class='post'>
The tools are what counts when it comes to frameworks like this. What good is your framework if it's too hard to use? So a design goal would be to allow the developer to get up and running as quickly as possible.<br /><br />In this post, I want to take the most important chunks out of <i style="font-weight: bold;">Dino</i>, our filesystem-change-responding-c#-auto-compiling-web-server-host application to show you the simplicity of the idea. There's also a couple of gems that you might find you'll come back to and research a little more.<br /><br />First up, we need a way to respond to file system events. We want to know when a file is created, when a file is deleted and when a file's contents changes. Too easy, let's employ the <a href="http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.aspx">FileSystemWatcher</a> class from the System.IO namespace.<br /><br /><script src="https://gist.github.com/4285000.js"></script> We've got some event handlers now attached to an object responding to the file types that we care about and when we care about them. We need to be able to serve this functionality over HTTP so we're going to need to embed a web server into our application. <a href="http://msdn.microsoft.com/en-us/library/system.net.httplistener.aspx">HttpListener</a> from the System.Net namespace makes short work of getting this accomplished.<br /><br /><script src="https://gist.github.com/4285007.js"></script> <br />Excellent. So, now we really need to bridge the gap here. We need to get this code compiled and served to client connections.<br /><br />Compiling C# code on the fly is actually a really painless experience. You fire up a <a href="http://msdn.microsoft.com/en-us/library/microsoft.csharp.csharpcodeprovider.aspx">CSharpCodeProvider</a>&nbsp;class, give it some compiler options (just as you would at the shell) through the <a href="http://msdn.microsoft.com/en-us/library/system.codedom.compiler.compilerparameters.aspx">CompilerParameters</a>&nbsp;class and off you go.<br /><br /><script src="https://gist.github.com/4285069.js"></script> <br />We're almost there. We just need to glue the assembly that we're generating onto the end of a http request so that we accomplish the serving of the application. Now this code is the real brains of the application, I think. It needs a-hell-of-a-lot-of work, but it accomplishes what is needed for this prototype.<br /><br />As you read through it, you'll see the deficiencies immediately but it should be pretty inspiring as to what you can load into this one method to make it a full-on application exchange.<br /><br /><script src="https://gist.github.com/4285052.js"></script> <br />... and of course, like any good console application, we signal that we want to get out with Control-C.<br /><br /><script src="https://gist.github.com/4285015.js"></script> <br />You should have a pretty clear idea in your heads now where this is going. It is time to make this a bit more of a fully-featured application though. Having it sit in prototypical form like this is depressing.<br /><br />I'll be back soon with some more progress, hopefully!</div>
<h2>Comments</h2>
<div class='comments'>
</div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2012/12/14/a-c-micro-framework/">
        A C# Micro-framework
      </a>
    </h1>

    <span class="post-date">14 Dec 2012</span>

    <h1>A C# Micro-framework</h1>
<div class='post'>
<h3>Introduction</h3><div>For a long time now, I've been creating web sites using Visual Studio, ASP.NET and C# for a living. It's a rewarding experience at times and at other times it's a frustrating mess of boilerplate, project files, sluggish compile times and all things horrible that impact the logical side of my brain.</div><div><br /></div><div>What I would like to try in this article is to put forward an idea as well as some prototype code that will help us all establish a good footing in the micro-framework arena for ASP.NET. There are some key focus-points that are negatives, but I'll use this list to establish a clear set of goals that I want this software/framework to solve. &nbsp;</div><div><br /></div><div>If you've ever used micro-frameworks to the like of <a href="http://www.sinatrarb.com/">Sinatra</a>, <a href="http://flask.pocoo.org/">Flask</a>&nbsp;or&nbsp;<a href="http://camping.io/">Camping</a>&nbsp;before it should be coming pretty clear where I'm heading in this post.</div><div><br /></div><h3>Why the Negativity?</h3><div>Well, I don't think I'm being negative - I just think that there are some attributes of ASP.NET programming that could be improved from the developers perspective to make them more productive. Take out all the guff and crud of setting up web applications, projects, routing, <b><u>AHHHHH!!! STOP!</u></b></div><div><b><u><br /></u></b></div><div>I can still hear the echoes of peoples' voices rattling around in my head about how we were so much more productive back in the ASP days and how .NET has slowed down the production of software. My boss may be unique with his point of view or this may be a common point of view. As developers we know that we have gained a hell-of-a-lot since the dark days of ASP development.&nbsp;</div><div><br /></div><div>Unfortunately, this doesn't equate to being more productive in the eyes of the not-so-technical, and it's true - we're not delivering software with the same velocity as we once were -- this is a whole blog post of its own with pro's and con's -- not today.</div><div><br /></div><h3>First stop: Tools</h3><div>If we're going to make this work for us, we're going to need some tools. The frameworks that I've mentioned above are all based on interpreted languages. Languages that benefit from <a href="http://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop">REPL</a> environments. So, I made a C# console application that:</div><div><ol><li>Scans the directory that it was invoked in for changes in C# files</li><li>Compiles these changes on the fly into an in-memory assembly</li><li>Serves the functions defined in this assembly as web pages</li></ol><div>It's very much so a poor man's MVC at the moment, but this isn't a failing of the idea it's a failing of only having a couple of hours to look at this problem last night.&nbsp;</div></div><div><br /></div><div>So this application, this console too, I have called "Dino".</div><div><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-1FktvoqDSos/UMqIjV2n1SI/AAAAAAAAAi0/VAcNOXu7sqQ/s1600/hello.gif" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="267" src="http://4.bp.blogspot.com/-1FktvoqDSos/UMqIjV2n1SI/AAAAAAAAAi0/VAcNOXu7sqQ/s400/hello.gif" width="400" /></a></div><div><br /></div><div>There's Dino, running in the bottom left-hand corner of the screen. Quietly re-compling changes on the fly that it detects in the C# file loaded into note pad on the right hand and serving the results of Temp.Hello() as an execution into the web browser on the left.</div><div><br /></div><div>For simplicity, I re-directed standard output for these assemblies to talk to the web socket so that I could just use <a href="http://msdn.microsoft.com/en-us/library/system.console.write.aspx">Console.Write</a>&nbsp;to send data back to the client.</div><div><br /></div><div>Here's some more work:</div><div><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-R8QH_gBXNFo/UMqJOChUknI/AAAAAAAAAi8/dd6wyzG2OC4/s1600/hello-2.gif" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="268" src="http://2.bp.blogspot.com/-R8QH_gBXNFo/UMqJOChUknI/AAAAAAAAAi8/dd6wyzG2OC4/s400/hello-2.gif" width="400" /></a></div><div><br /></div><div>To show that this is a dynamic environment, Temp.cs just had a Goodbye and Clock method added to it. You can see that in chrome I'm calling the Clock method.</div><div><br /></div><div>Finally:</div><div><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-i3WUd1nsvgc/UMqJdNoWWDI/AAAAAAAAAjE/wnJxDDE8Bkw/s1600/run-forest.gif" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="268" src="http://4.bp.blogspot.com/-i3WUd1nsvgc/UMqJdNoWWDI/AAAAAAAAAjE/wnJxDDE8Bkw/s400/run-forest.gif" width="400" /></a></div><div><br /></div><div>I just dropped a new file "Temp2.cs" into the folder with a method called "Run". You can see that chrome is now&nbsp;targeting&nbsp;Temp2 rather than Temp in the previous screenshots.</div><div><br /></div><div><br /></div><div>Ok, great. We've got the programmer focused on what's important. Just filling these methods out with implementation that matters! Feeling productive already albeit in a very minimalistic way.</div><div><br /></div><h3>Next Steps</h3><div>Right. As I said above, this is very early days and I haven't had much time to spend doing the implementation. It could turn into something very productive (doing actual useful things) rather quickly. Some pieces that immediately come to mind that I'd like to see are:</div><div><ul><li>Changing the standard output pipe to a more friendly http response object</li><li>Providing a http request object for access to query strings, form variables, cookies, etc</li><li>or .. rather providing these details as parameters to this method (much like ASP.NET MVC)</li><li>Flexible attribute-based routing</li><li>A templating system (did I hear you say razor?)</li><li>A deployment strategy: perhaps a http module that would host this style of application so that it can be a fully blown IIS application in production?</li><li>Automatically running unit-tests after automatic compilations?</li></ul></div>You can see here that a lot of this has already been implemented by existing technologies right out of the .NET toolbox. The whole ASP.NET http request/response pair do a great job in facilitating this communication and the MVC framework also gives you flexible routing and a really nice templating framework. If I could find a way to mix these in, we'd just about be on a winner here.<br /><br />I will put Dino up in my <a href="https://github.com/tuttlem">github&nbsp;repository</a>&nbsp;shortly. There's a few preliminary things I'd like to take care of first before I commit it in.<br /><br />I'll keep you posted!</div>
<h2>Comments</h2>
<div class='comments'>
</div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2012/12/13/rvm-debian/">
        RVM & Debian
      </a>
    </h1>

    <span class="post-date">13 Dec 2012</span>

    <h1>RVM & Debian</h1>
<div class='post'>
It's always nice to have a sandboxed environment for all of your little projects. I know with how frequently I'm jumping between technologies on the same machine, I always like to use a sandbox technology of choice for the particular platform.<br /><br />This is a quick walk through on getting RVM up and running on a debian machine.<br /><br />First up, you need to download an install RVM:<br /><pre class="brush:shell;">$ curl -L get.rvm.io | bash -s stable</pre><br />Load RVM into your environment:<br /><pre class="brush:shell;">$ source ~/.rvm/scripts/rvm</pre><br />Check for additional requirements that rubies (you're about to install) need:<br /><pre class="brush:shell;">$ rvm requirements</pre><br />It's <b><u>strongly advised</u></b> that you follow the suggestions above for the Ruby(ies) that you want to run:<br /><br />Install the Ruby that you want to use:<br /><pre class="brush:shell;">$ rvm install 1.9.3</pre><br />Get Rubonic (yes, it's a word ... I ... I ... I think)<br /><pre class="brush:shell;">[michael@deb-02] ~/src $ which ruby                      <br />/home/michael/.rvm/rubies/ruby-1.9.3-p327/bin/ruby</pre><br />The basics of RVM<br /><a href="https://rvm.io/rvm/basics/">https://rvm.io/rvm/basics/</a></div>
<h2>Comments</h2>
<div class='comments'>
</div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2012/12/12/generic-value-interpolation/">
        Generic value interpolation
      </a>
    </h1>

    <span class="post-date">12 Dec 2012</span>

    <h1>Generic value interpolation</h1>
<div class='post'>
<h3>Introduction</h3>The core of animation in software (not&nbsp;necessarily&nbsp;graphical) is movement. That movement is between known points to achieve and overall effect. Such well-known movements might be a human moving their legs&nbsp;alternatively&nbsp;so that they can <b>walk </b>or a sound constantly moving from low to high to make a <b>siren</b>&nbsp;or moving your mouse cursor <b>automatically.</b>&nbsp;All of these things share the same premise. An attribute of the object needs to have its position interpolated from a starting point to an ending point over a period of time.<br /><br />Some of these interpolations repeat, some do not.<br /><br />Today's post is about interpolating values between two points, but it's about doing it with any type and with any interpolation scheme. Let's break these parts down.<br /><br /><h3>Doing it with any type</h3><div>The idea here is that anything (within reason) can be interpolated. In real C/C++ terms, I mean short, int, long, float, double, char, etc. A little more interestingly when dealing with spatial objects, we could define our own&nbsp;Cartesian&nbsp;co-ordinate object - give this object X and Y attributes and then interpolate this co-ordinate between two points.<br /><br /></div><h3>Interpolation schemes + some math</h3><div>It's the small details that matter. Linear interpolation is the simplest form of interpolation leaning on the whole "the shortest distance between two points is a straight line". Linear interpolation will take its sequence values for progressing the object through its interpolation life using:</div><blockquote class="tr_bq"><i>y = c + mx</i></blockquote>Which looks dangerously close to the standard formula you would use to draw a straight line. In this case <i style="font-weight: bold;">c </i>would be our starting point, <i style="font-weight: bold;">m</i>&nbsp;would be the distance (or length) between the start and end points and <i style="font-weight: bold;">x </i>defines how far along our interpolation progression we are taking the form in range of 0.0 up to 1.0.<br /><br />Another interesting scheme is trigonometric in nature. Using a soft curve to get between two points can be a softer approach. Trigonometric interpolation will take its sequence values for progressing the object through its interpolation life using:<br /><blockquote class="tr_bq"><i>y = c + (sin(x * (PI / 2)) * m)</i></blockquote>Again, we have alike named variables in that <i style="font-weight: bold;">c </i>is our start point, <i style="font-weight: bold;">x </i>is our progress through the interpolated progression and <i style="font-weight: bold;">m</i>&nbsp;is the distance. Notice how our progress, <i style="font-weight: bold;">x </i>is multiplied by <i style="font-weight: bold;">(PI / 2)</i>&nbsp;only talking us 1 quarter through the progress of the curve. This is simply because we're at 0% progress at 0 degress and 100% at 90 degrees.<br /><br /><h3>Show me some code</h3><div>First off, we have a base "tweener" object that will manage all of the mundane tasks that this interpolater will need to undergo in order to&nbsp;realize&nbsp;these tweened-values. You'll notice that it is in fact a templated C++ class .</div><div><br /><script src="https://gist.github.com/4262914.js"></script></div><div><br /></div><div><br /></div><div>Ignore the timer class for now. It's there just so we can make the interpolations happen with respect to time. We move ourselves along the interpolation progression just with some simple math with regards to time. To be a little more polite about things, we detect when we're at the start and just send the start value and detect when we're at the end and just send the end value - rather than calculating this over and over.<br /><br /><script src="https://gist.github.com/4262934.js"></script></div><div><br /></div><div>The custom implementations for getting actual values (from types of interpolation) are as simple as this:<br /><br /><script src="https://gist.github.com/4262954.js"></script> <br /><br />So you can see that these custom implementations marry very closely to the&nbsp;formula&nbsp;we specified above. I think that this design documents the implementer's intention very clearly by not having to worry about the progression code.<br /><br />The choice of using C++ templates also allows future implementations to target specific types. Whilst the implementations given in this article will work well for scalar values, they won't translate very well to complex class types that don't correctly implement operator overloading with mathematical correctness in mind. That being said, if the scope of implementation is beyond what the generic base provides, it's only a matter of specifying the specific type when implementing your own <i style="font-weight: bold;">value_internal</i>&nbsp;method.<br /><br />Enjoy.<br /><br /><h3>A few tweeners more</h3></div><div>Just playing around with the code set that I have here, I've been able to make logarithmic and parabolic tweeners relatively easy. It would be great to be able to control the co-effecients in the parabolic formula, but for the time being it's a quadratic class:</div><blockquote class="tr_bq"><i>y = x<sup>2</sup> + c</i></blockquote><br /><script src="https://gist.github.com/4264400.js"></script> <br /></div>
<h2>Comments</h2>
<div class='comments'>
</div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2012/12/08/simple-logging-in-c/">
        Simple logging in C
      </a>
    </h1>

    <span class="post-date">08 Dec 2012</span>

    <h1>Simple logging in C</h1>
<div class='post'>
Logging is probably one of the most important services you can offer your application. Your programs have information that needs to be expressed to the user, in fact in parts it's important for your program to be almost paranoid that it hasn't said anything.<br /><br />All things should be controllable though. Putting your application into production with a paranoid level of logging doesn't make for very happy sys-admins, so this is left as an exercise to the reader.<br /><br />Here, I want to present you a configurable but most importantly, a usable logging framework that you can drop into your C projects without much effort at all.<br /><br />Let's go through the header!<br /><br /><script src="https://gist.github.com/4239593.js?file=log.h"></script> <br /><br />This is very simple stuff. Only one function "_ced_log" is defined that's used by this header. The user is encouraged to access the logging functionality by proxy of the macros defined (ced_log and ced_logf). ced_log takes in the same parameter structure as a printf call allowing the very natural format strings to be used for your logging. ced_logf takes the structure of fprintf where you can direct your log information to a specific file handle.<br /><br />Again, with some small modifications you can direct all of your logs into a file by default. I just like to throw all mine out to the console. I hate surprises (in development)!!<br /><br />The implementation for this library piece is also very simple with only one function needing to be filled out:<br /><br /><script src="https://gist.github.com/4239593.js?file=log.c"></script> <br />Here is where you can really make this module your own. The default format that I have going in here has the current process ID and date/time stamp. I find these very useful during the fault-finding process once a unit of software is running. The most important thing to draw from this is you can change the default makeup of a log line by changing this code.<br /><br />I use this code just about everywhere. I use it so much that I have included it in my library that it available from github <a href="https://github.com/tuttlem/libced">here</a>.</div>
<h2>Comments</h2>
<div class='comments'>
</div>

  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page34">Older</a>
  
  
    
      <a class="pagination-item newer" href="/page32">Newer</a>
    
  
</div>
      </div>
    </div>

  </body>
</html>
