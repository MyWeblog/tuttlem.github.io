---
layout: post
title: A Camera Implementation in C++
date: 2013-12-30
comments: false
---

<h1>{{ page.title }}</h1>
<div class='post'>
<h3>Introduction</h3>One of the most important elements of any 3D application is its camera. A camera allows you to move around in your world and orient your view. In today's post, I'll put together a code walk through that will take you through a simple camera implementation.<br /><br /><h3>The Concept</h3>There are two major components of any camera. They are position and orientation. Position is fairly easy to grasp, it's just where the camera is and is identified using a normal 3-space vector.<br /><br />The more difficult of the two concepts is orientation. The best description for this that I've found is on the <a href="http://en.wikipedia.org/wiki/Flight_dynamics">Flight Dynamics</a> page on wikipedia. The following image has been taken from that article and it outlines the plains that orientation can occur. Of course, the image's subject is an aircraft but the same concepts apply to a camera's orientation:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-ps-FvMLXC0U/UsEQcjCw5gI/AAAAAAAAAxk/v-ZbdV9aAfc/s1600/Rollpitchyawplain.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="209" src="http://2.bp.blogspot.com/-ps-FvMLXC0U/UsEQcjCw5gI/AAAAAAAAAxk/v-ZbdV9aAfc/s320/Rollpitchyawplain.png" width="320" /></a></div><br /><br /><br /><br />The "pitch" describes the orientation around the x-axis, the "yaw" describes the orientation around the y-axis and the "roll" describes the orientation around the z-axis.<br /><br />With all of this information on board, the requirements of our camera should become a little clearer. We need to keep track of the following about the camera:<br /><br /><ul><li>Position</li><li>Up orientation (yaw axis)</li><li>Right direction (pitch axis)</li><li>Forward (or view) direction (roll axis)</li></ul>&nbsp;We'll also keep track of how far we've gone around the yaw, pitch and roll axis.<br /><br /><h3>Some Maths (and code)</h3>There's a handful of really useful equations that are going to help us out here. With all of the information that we'll be managing and how tightly related each axis is considering they're all relating to the same object - you can see how interactive it can be just by modifying one attribute.<br /><br />When the <b>pitch</b> changes:<br /><br /><pre>forwardVector = (forwardVector * cos(pitch)) + (upVector * sin(pitch))<br />upVector = forwardVector x rightVector</pre><br /><script src="https://gist.github.com/tuttlem/8178594.js"></script> <br />When the <b>yaw</b> changes:<br /><br /><pre>forwardVector = (forwardVector * cos(yaw)) - (rightVector * sin(yaw))<br />rightVector = forwardVector x upVector</pre><br /><script src="https://gist.github.com/tuttlem/8178620.js"></script> <br />When the <b>roll</b> changes:<br /><br /><pre>rightVector = (rightVector * cos(roll)) + (upVector * sin(roll))<br />upVector = forwardVector x rightVector</pre><br /><script src="https://gist.github.com/tuttlem/8178660.js"></script> Ok, so that's it for orientation. Reading through the equations above, you can see that the calculation of the forward vector comes out of some standard rotations. The "x" operator that I've used above denotes vector <b>cross product</b>.<br /><br />Now that we're keeping track of our current viewing direction, up direction and right direction; performing camera movements is really easy.<br /><br />I've called these "advance" (move along the forward plane), "ascend" (move along the up plane) and "strafe" (move along the right plane).<br /><br /><script src="https://gist.github.com/tuttlem/8178706.js"></script> All we are doing here is just moving along those planes that have been defined for us via orientation. Movement is simple.<br /><br /><h3>Integrating</h3>All of this code/math is great up until we need to apply it in our environments. Most of the work that I do centralises around OpenGL, so I've got a very handy utility function (from GLU) that I use called <a href="http://www.opengl.org/sdk/docs/man2/xhtml/gluLookAt.xml">gluLookAt</a>. Plugging these values in is rather simple:<br /><br /><script src="https://gist.github.com/tuttlem/8178731.js"></script> We calculate our viewpoint as (position - forwardVector) and really just plug the literal values into this function. There is a lot of information on the gluLookAt documentation page that you can use if OpenGL isn't your flavor to simulate what it does.<br /><br />That's it for a simple camera! <br /><br /><br /></div>
<h2>Comments</h2>
<div class='comments'>
</div>
