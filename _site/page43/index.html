<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Cogs and Levers &middot; A blog full of technical stuff
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>A place for thoughts, ideas, tutorials and bookmarks. My brain can only hold so much, you know.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    

    
    
      
        
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    

    <a class="sidebar-nav-item" href="https://github.com/tuttlem/tuttlem.github.io">GitHub</a>
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2014. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <label for="sidebar-checkbox" class="sidebar-toggle"></label>

          <h3 class="masthead-title">
            <a href="/" title="Home">Cogs and Levers</a>
            <small>A blog full of technical stuff</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2012/11/20/be-nice-and-die-well/">
        Be nice and die well
      </a>
    </h1>

    <span class="post-date">20 Nov 2012</span>

    <p>It&#39;s a morbid title, I agree but it is quite important. Unix daemons really need to listen to the messages (read as: signals) being sent to them and responding correctly. At the very least, if every daemon implemented the following it&#39;d be a breath of fresh air:</p>

<div class="highlight"><pre><code class="c"><span class="cm">/** Responds to signals of interest */</span>                                                                    
<span class="kt">void</span> <span class="nf">daemon_signalhandler</span><span class="p">(</span><span class="kt">int</span> <span class="n">sig</span><span class="p">)</span> <span class="p">{</span>                                      
                                                                            
   <span class="k">switch</span> <span class="p">(</span><span class="n">sig</span><span class="p">)</span> <span class="p">{</span>                                                         
                                                                            
      <span class="k">case</span> <span class="n">SIGHUP</span>:                                                        
         <span class="cm">/* this should just refresh configs and restart */</span>                                      
         <span class="k">break</span><span class="p">;</span>                                                           
                                                                            
      <span class="k">case</span> <span class="n">SIGTERM</span>:                                                       
         <span class="cm">/* mark the server as no longer running */</span>                                               
         <span class="k">break</span><span class="p">;</span>                                                           
   <span class="p">}</span>                                                                      
                                                                            
<span class="p">}</span></code></pre></div>

<p>This block of code by itself is pretty useless. The other half of the equation is attaching this function to the signals of interest as well as ignoring signals we&#39;re not interested in (or that we&#39;re not interested in those signals turning our daemon to toast).</p>

<div class="highlight"><pre><code class="c"><span class="cm">/* attach the signal handlers now */</span>                                  
<span class="n">signal</span><span class="p">(</span><span class="n">SIGCHLD</span><span class="p">,</span> <span class="n">SIG_IGN</span><span class="p">);</span>                                             
<span class="n">signal</span><span class="p">(</span><span class="n">SIGTSTP</span><span class="p">,</span> <span class="n">SIG_IGN</span><span class="p">);</span>                                             
<span class="n">signal</span><span class="p">(</span><span class="n">SIGTTOU</span><span class="p">,</span> <span class="n">SIG_IGN</span><span class="p">);</span>                                             
<span class="n">signal</span><span class="p">(</span><span class="n">SIGTTIN</span><span class="p">,</span> <span class="n">SIG_IGN</span><span class="p">);</span>                                             
<span class="n">signal</span><span class="p">(</span><span class="n">SIGHUP</span><span class="p">,</span> <span class="n">daemon_signalhandler</span><span class="p">);</span>                                 
<span class="n">signal</span><span class="p">(</span><span class="n">SIGTERM</span><span class="p">,</span> <span class="n">daemon_signalhandler</span><span class="p">);</span></code></pre></div>

<p>Well, that&#39;s it really and remember - die well.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2012/11/19/movie-time-unix/">
        Movie Time Unix
      </a>
    </h1>

    <span class="post-date">19 Nov 2012</span>

    <p>Breakout the pop-corn, it&#39;s movie time.</p>

<p><a href="http://techchannel.att.com/play-video.cfm/2012/2/22/AT&amp;amp;T-Archives-The-UNIX-System">http://techchannel.att.com/play-video.cfm/2012/2/22/AT&amp;T-Archives-The-UNIX-System</a></p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2012/11/19/haskell-cards/">
        Haskell Cards
      </a>
    </h1>

    <span class="post-date">19 Nov 2012</span>

    <p>I need to crawl before I can walk, so a lot of &quot;toy code&quot; is being written using Haskell. It&#39;s taken me a while to get to this point, but I now have cards being shuffled to players:</p>

<div class="highlight"><pre><code class="haskell"><span class="kr">module</span> <span class="nn">Cards</span> <span class="kr">where</span>
 
<span class="kr">import</span> <span class="nn">System.Random</span>
<span class="kr">import</span> <span class="nn">Data.Maybe</span>
<span class="kr">import</span> <span class="nn">Data.List</span>
<span class="kr">import</span> <span class="nn">Data.Function</span>
 
<span class="kr">import</span> <span class="nn">Test.HUnit</span>
<span class="kr">import</span> <span class="nn">Test.QuickCheck</span>
 
<span class="c1">-- | Card values for uno cards</span>
<span class="kr">data</span> <span class="kt">CardValue</span> <span class="ow">=</span> <span class="kt">Naught</span> <span class="o">|</span> <span class="kt">One</span> <span class="o">|</span> <span class="kt">Two</span> <span class="o">|</span> <span class="kt">Three</span>
    <span class="o">|</span> <span class="kt">Four</span> <span class="o">|</span> <span class="kt">Five</span> <span class="o">|</span> <span class="kt">Six</span> <span class="o">|</span> <span class="kt">Seven</span> <span class="o">|</span> <span class="kt">Eight</span> <span class="o">|</span> <span class="kt">Nine</span>
    <span class="o">|</span> <span class="kt">Skip</span> <span class="o">|</span> <span class="kt">Reverse</span> <span class="o">|</span> <span class="kt">DrawTwo</span> <span class="o">|</span> <span class="kt">Wild</span> <span class="o">|</span> <span class="kt">WildDrawFour</span>
    <span class="kr">deriving</span> <span class="p">(</span><span class="kt">Show</span><span class="p">,</span> <span class="kt">Eq</span><span class="p">,</span> <span class="kt">Enum</span><span class="p">)</span>
 
<span class="c1">-- | Possible card colours</span>
<span class="kr">data</span> <span class="kt">CardColour</span> <span class="ow">=</span> <span class="kt">Red</span> <span class="o">|</span> <span class="kt">Blue</span> <span class="o">|</span> <span class="kt">Green</span> <span class="o">|</span> <span class="kt">Yellow</span>
    <span class="kr">deriving</span> <span class="p">(</span><span class="kt">Show</span><span class="p">,</span> <span class="kt">Eq</span><span class="p">,</span> <span class="kt">Enum</span><span class="p">)</span>
 
<span class="c1">-- | Defines the attributes of a card</span>
<span class="kr">data</span> <span class="kt">Card</span> <span class="ow">=</span> <span class="kt">Card</span> <span class="kt">CardValue</span> <span class="p">(</span><span class="kt">Maybe</span> <span class="kt">CardColour</span><span class="p">)</span>
    <span class="kr">deriving</span> <span class="p">(</span><span class="kt">Show</span><span class="p">)</span>
 
<span class="c1">-- | Seeds a list of cards with a random value</span>
<span class="nf">seedCards</span> <span class="ow">::</span> <span class="kt">StdGen</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="kt">Card</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="p">[(</span><span class="kt">Card</span><span class="p">,</span> <span class="kt">Int</span><span class="p">)]</span>
<span class="nf">seedCards</span> <span class="n">g</span> <span class="kt">[]</span> <span class="ow">=</span> <span class="kt">[]</span>
<span class="nf">seedCards</span> <span class="n">g</span> <span class="p">(</span><span class="n">c</span><span class="kt">:</span><span class="n">cs</span><span class="p">)</span> <span class="ow">=</span> <span class="n">x</span><span class="kt">:</span><span class="n">seedCards</span> <span class="n">ng</span> <span class="n">cs</span>
    <span class="kr">where</span> <span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="n">ng</span><span class="p">)</span> <span class="ow">=</span> <span class="n">randomR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span> <span class="n">g</span> <span class="ow">::</span> <span class="p">(</span><span class="kt">Int</span><span class="p">,</span> <span class="kt">StdGen</span><span class="p">)</span>
                   <span class="n">x</span> <span class="ow">=</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">seed</span><span class="p">)</span>
 
<span class="c1">-- | Makes a randomly shuffled deck of cards</span>
<span class="nf">makeShuffledDeck</span> <span class="ow">::</span> <span class="kt">StdGen</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="kt">Card</span><span class="p">]</span>
<span class="nf">makeShuffledDeck</span> <span class="n">g</span> <span class="ow">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">|</span> <span class="n">c</span> <span class="ow">&lt;-</span> <span class="n">sorted</span><span class="p">,</span> <span class="kr">let</span> <span class="n">x</span> <span class="ow">=</span> <span class="n">fst</span> <span class="n">c</span><span class="p">]</span>
    <span class="kr">where</span> <span class="n">cards</span> <span class="ow">=</span> <span class="n">seedCards</span> <span class="n">g</span> <span class="n">deck</span>
         <span class="n">sorted</span> <span class="ow">=</span> <span class="n">sortBy</span> <span class="p">(</span><span class="n">compare</span> <span class="p">`</span><span class="n">on</span><span class="p">`</span> <span class="n">snd</span><span class="p">)</span> <span class="n">cards</span>
           <span class="n">deck</span> <span class="ow">=</span> <span class="n">val</span> <span class="o">++</span> <span class="n">take</span> <span class="mi">10</span> <span class="p">(</span><span class="n">cycle</span> <span class="n">spec</span><span class="p">)</span>
            <span class="n">val</span> <span class="ow">=</span> <span class="p">[</span><span class="kt">Card</span> <span class="n">v</span> <span class="p">(</span><span class="kt">Just</span> <span class="n">c</span><span class="p">)</span> <span class="o">|</span> <span class="n">v</span> <span class="ow">&lt;-</span> <span class="p">[</span><span class="kt">Naught</span> <span class="o">..</span> <span class="kt">DrawTwo</span><span class="p">],</span> <span class="n">c</span> <span class="ow">&lt;-</span> <span class="p">[</span><span class="kt">Red</span> <span class="o">..</span> <span class="kt">Yellow</span><span class="p">]]</span>
           <span class="n">spec</span> <span class="ow">=</span> <span class="p">[</span><span class="kt">Card</span> <span class="n">v</span> <span class="kt">Nothing</span> <span class="o">|</span> <span class="n">v</span> <span class="ow">&lt;-</span> <span class="p">[</span><span class="kt">Wild</span> <span class="o">..</span> <span class="kt">WildDrawFour</span><span class="p">]]</span>
 
<span class="nf">tests</span> <span class="ow">=</span> <span class="kt">TestList</span> <span class="o">$</span> <span class="n">map</span> <span class="kt">TestCase</span>
    <span class="p">[</span><span class="n">assertEqual</span> <span class="s">&quot;add tests here&quot;</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">]</span>
 
<span class="nf">prop_empty</span> <span class="n">c1</span> <span class="ow">=</span> <span class="p">(</span><span class="n">c1</span><span class="ow">::</span><span class="kt">Int</span><span class="p">)</span> <span class="o">==</span> <span class="n">c1</span>
 
<span class="nf">runTests</span> <span class="ow">=</span> <span class="kr">do</span>
    <span class="n">runTestTT</span> <span class="n">tests</span>
    <span class="n">quickCheck</span> <span class="n">prop_empty</span>
 
<span class="c1">-- | Main entry point</span>
<span class="nf">main</span> <span class="ow">::</span> <span class="kt">IO</span> <span class="nb">()</span>
<span class="nf">main</span> <span class="ow">=</span> <span class="n">runTests</span></code></pre></div>

<p>There is a lot more to do before this becomes of use. The real think work being conducted here is really between seedCards and makeShuffledDeck. These two functions alone provide randomization to the ordered deck so it can be shuffled.</p>

<p>I hope to post some more on this topic, but I&#39;d like to have a fully functional (or close to) application before I do so.</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2012/11/19/book-on-algorithms/">
        Book on Algorithms
      </a>
    </h1>

    <span class="post-date">19 Nov 2012</span>

    <p>Just so I don&#39;t lose track of it, <a href="http://www.cs.berkeley.edu/%7Evazirani/algorithms.html">here&#39;s</a> a really good looking book on Algorithms.</p>

<p>Will be worth some study and the centre of a few more blog posts to come!</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2012/11/18/os-development-links/">
        OS Development Links
      </a>
    </h1>

    <span class="post-date">18 Nov 2012</span>

    <p>Over the past couple of months, I&#39;ve compiled and refined a list of links that have been of assistance though my OS development journey.</p>

<ul>
<li><a href="http://www.osdever.net/bkerndev/index.php">Bona Fide OS Development</a></li>
<li><a href="http://www.jamesmolloy.co.uk/tutorial_html/index.html">Roll your own toy UNIX-clone OS</a></li>
<li><a href="http://wiki.osdev.org/Tutorials">OSDev Tutorials</a></li>
<li><a href="http://forum.osdev.org/">OSDev Forums</a></li>
</ul>

  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page44">Older</a>
  
  
    
      <a class="pagination-item newer" href="/page42">Newer</a>
    
  
</div>
      </div>
    </div>

  </body>
</html>
