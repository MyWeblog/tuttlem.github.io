---
layout: post
title: MapReduce parameters in Mongo
date: 2013-03-04
comments: false
---

<h1>{{ page.title }}</h1>
<div class='post'>
<h3>Introduction</h3><div>I had <a href="http://cogsandlevers.blogspot.com.au/2013/01/a-brief-mapreduce-tutorial-for-mongodb.html">previously written</a> about MapReduce within the MongoDB context and as I refer back to that article I'm noticing that I'm using more features of this framework than I have explained initially. I today's post, I want to go through all of the parameters when defining a MapReduce query within MongoDB.</div><div><br /></div><h3>MapReduce</h3><div>Referring back to <a href="http://docs.mongodb.org/manual/applications/map-reduce/">the manual on MapReduce</a>, the function signature looks as follows:</div><div><br /><pre>db.collection.mapReduce(<br />  &lt;mapfunction&gt;,<br />  &lt;reducefunction&gt;,<br />  {<br />    out: &lt;collection&gt;,<br />    query: &lt;document&gt;,<br />    sort: &lt;document&gt;,<br />    limit: &lt;number&gt;,<br />    finalize: &lt;function&gt;,<br />    scope: &lt;document&gt;,<br />    jsMode: &lt;boolean&gt;,<br />    verbose: &lt;boolean&gt;<br />  }<br />)</pre></div><div><br /><b>mapFunction</b><br /><div>The map function is a function that takes no arguments that you use to associate values to keys. Using the emit function, you can map values to a key for use later in your reduce function.</div><div><br /></div><b>reduceFunction</b><br />The reduce function is a function that will take in a single key and an array of values. The purpose of the code inside the reduce function is to reduce your mapped values down into the aggregate values that you're looking for.<br /><br /><b>out</b></div><div>The out parameter takes the name of the collection that your mapReduce query will target. This is where the result will be stored.</div><div><br /></div><b>query</b><br /><div>The query parameter takes a document which acts as query criteria that will filter the data set that the map function (and therefore by process - the reduce function) will actually see.</div><div><br /></div><b>limit</b><br /><div>The limit parameter allows you to constrain the number of items presented to your mapReduce process.</div><div><br /></div><b>finalize</b><br /><div>The finalize function is a function that is executed after your reduce process. It's presented with a key and reduced value to work with. This is where you'd perform any ancillary processing on the reduced set prior to returning the result.</div><div><br /></div><b>scope</b><br /><div>The scope parameter allows you to specify global variables that your map, reduce and finalize functions can access. This is particularly handy for MapReduce operations that are reliant on parameters external to your process.</div><div><br /></div><b>jsMode</b><br /><div>The jsMode parameter determines how the MapReduce process will handle data between the map and reduce steps. Turning this on will force mongo to not convert your mapped results into BSON objects. This can make your queries run faster but they are constrained by the number of unique keys that can be worked on.</div><div><br /></div><b>verbose</b><br />Turning the verbose parameter on will give you some timing profiling for your query.<br /><br /><br />&nbsp;That's it for the MapReduce function call within Mongo.</div>
<h2>Comments</h2>
<div class='comments'>
</div>
