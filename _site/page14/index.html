<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Cogs and Levers &middot; A blog full of technical stuff
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>A place for thoughts, ideas, tutorials and bookmarks. My brain can only hold so much, you know.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    

    
    
      
        
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    

    <a class="sidebar-nav-item" href="https://github.com/tuttlem/tuttlem.github.io">GitHub</a>
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2014. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <label for="sidebar-checkbox" class="sidebar-toggle"></label>

          <h3 class="masthead-title">
            <a href="/" title="Home">Cogs and Levers</a>
            <small>A blog full of technical stuff</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2013/02/09/gui-programming-with-gtk-in-haskell/">
        GUI Programming with Gtk in Haskell
      </a>
    </h1>

    <span class="post-date">09 Feb 2013</span>

    <h1>GUI Programming with Gtk in Haskell</h1>
<div class='post'>
<h3>Introduction</h3><div>If you do spend a bit of time writing applications in Haskell, you'll probably be writing a lot of console programs. I love writing console programs but sometimes you just want a bit of GUI. In today's post, I want to do a walkthrough of getting an application up and running with the help of Gtk Haskell bindings&nbsp;<a href="http://projects.haskell.org/gtk2hs/">Gtk2Hs</a>. The result code is actually the "Hello World" example they provide, but this should still serve as a good walkthrough.</div><div><br /></div><h3>Gtk2Hs</h3><div>As I mentioned in the introduction, we'll be using the Haskell bindings for Gtk&nbsp;<a href="http://projects.haskell.org/gtk2hs/">Gtk2Hs</a>&nbsp;to accomplish our UI. As you'd expect, it's very much like writing Gtk applications using other language bindings, only this way we get to use our functional brains to get there.</div><div><br /></div><div>Take a look through the package up on <a href="http://hackage.haskell.org/package/gtk-0.12.0">Hackage</a>&nbsp;as well as the <a href="http://www.haskell.org/haskellwiki/Gtk2Hs">Wiki Article</a> about the library. This should give even the uninitiated a bit of the background story behind the library.</div><div><br /></div><h3>Project Setup</h3><div>Start a new project in the usual fashion with cabal.</div><div><br /><pre class="brush:shell">$ mkdir guitest<br />$ cd guitest<br />$ touch LICENSE<br />$ cabal init<br /></pre></div><div><br />There are quite a list of dependencies to use the package "gtk" as listed on the&nbsp;<a href="http://hackage.haskell.org/package/gtk-0.12.0">Hackage</a>&nbsp;page. One dependency is that you need to have "gtk2hs-buildtools" installed. Get these installed into your project with the following command.<br /><br /><pre class="brush:shell">$ cabal-dev install gtk2hs-buildtools</pre><br />Now that you've installed these tools, you'll need to get them on your path so that they are available at compile time. You can do this with the following command.<br /><br /><pre class="brush:shell">$ export PATH=~/projdir/cabal-dev/bin:$PATH</pre><br />The other requirements which might just be localised to my environment (OSX 10.8) is that I needed to make pkg-config aware of the "pc" files for X11. I did this simply by running the following command.<br /><br /><pre class="brush:shell">export PKG_CONFIG_PATH=/opt/X11/lib/pkgconfig/</pre><br />Finally for dependencies is making your project file aware of the dependencies on the application. As I mentioned before, there are a few and these just get listed under your "build-depends" attribute in your cabal project file. Here's how mine looks.<br /><br /><pre class="brush:plain">build-depends:       base ==4.5.*,   <br />                     gtk ==0.12.4,   <br />                     cairo ==0.12.4, <br />                     glib ==0.12.4,  <br />                     pango ==0.12.4, <br />                     gio ==0.12.4    </pre><br /><br />Create a new file in your project called "Test.hs" and add the following code. This code is very simple. It opens a window, adds a button (with an event handler attached) and that's about it.<br /><br /><script src="https://gist.github.com/tuttlem/4744834.js"></script> <br />This code is pretty straight forward and it almost reads like english so you can see exactly what it's doing.<br /><br />Now that we have a main module, it's time to tell our project file that it exists and that it's where we'll find our "main" function. You do this by setting the "main-is" attribute to this file's name "Test.hs" in your cabal file.<br /><br /><pre class="brush:plain">main-is:             Test.hs</pre><br /><h3>Build and Run</h3></div><div>It's time to give this bad boy a go. This first build will feel like it's taking forever, but it'll only be on the first time while cabal-dev gets all of the dependencies together and builds them. Subsequent builds will be much quicker.</div><div><br /></div><div>Build your project with the following command.</div><div><br /><pre class="brush: shell">$ cabal-dev install</pre></div><div><br />Go and make a coffee, then another one .. do all of your shopping, come back ... aaannnnndd ....<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-Mz5UA3upxBM/URYw0pKxg_I/AAAAAAAAAmQ/DoK8SkCl4YM/s1600/Screen+Shot+2013-02-09+at+9.18.58+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-Mz5UA3upxBM/URYw0pKxg_I/AAAAAAAAAmQ/DoK8SkCl4YM/s1600/Screen+Shot+2013-02-09+at+9.18.58+PM.png" /></a></div>You end up with a rather unimpressive (but working) gtk application! Well, there's still more to learn on this topic, this is only the start.</div></div>
<h2>Comments</h2>
<div class='comments'>
</div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2013/02/01/mutable-state-with-ioref/">
        Mutable State with IORef
      </a>
    </h1>

    <span class="post-date">01 Feb 2013</span>

    <h1>Mutable State with IORef</h1>
<div class='post'>
<h3>Introduction</h3><div>Haskell goes to great lengths to control state but one way you can achieve mutable state in Haskell is by use of <a href="http://www.haskell.org/ghc/docs/latest/html/libraries/base/Data-IORef.html">IORef</a>. IORef gives you the ability to assign a reference to a variable in the <a href="http://www.haskell.org/ghc/docs/latest/html/libraries/base/System-IO.html#t:IO">IO monad</a>. This at least decorates your code in such a way that it's obvious to you, the developer and Haskell that there will be side effects.</div><div><br /></div><div>Today's post, I'll create a very simple example usage of IORef. We'll construct a counter that we can increment and decrement.</div><div><br /></div><h3>Declaring our type</h3><div><br /><script src="https://gist.github.com/4689143.js"></script> First of all, we import Data.IORef to give us access to IORef. We declare our counter data type using record style, the only member of which is the value that counts. It's an IORef Int to mean it references a variable in the IO monad that will be of type Int. So, it's not so blatant that you're dragging the integer value around with you, rather you're dragging something closer to a pointer to the value or reference.<br /><br />To build one of our types, we need to use <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-IORef.html#v:newIORef">newIORef</a>&nbsp;which references our actual value and we wrap it up in our Counter data type.<br /><br /><script src="https://gist.github.com/4689602.js"></script> <br /><br />makeCounter takes in an initial integer that will seed our counter and returns a Counter in the IO monad.<br /><br />Getting our hands on the reference and doing something with it is pretty simple with the use of <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-IORef.html#v:modifyIORef">modifyIORef</a>. Using this information, we can increment our counter with the following function.<br /><br /><script src="https://gist.github.com/4689654.js"></script> modifyIORef actually gives us the ability to pass a function to modify the referenced value. Be careful with modifyIORef though. As with a lot of things in Haskell, this is lazy. We're operating on IO actions here so it's all "promises to do something" or "will do it later when I need to" type operations, so repeatedly calling this without emitting the value will make these promises pile up. There is a strict and non-lazy evaluated version called modifyIORef'.<br /><br />Finally, when we want to get our hands on the referenced value and do something with it (in our example here, we'll just present it to screen) we use <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-IORef.html#v:readIORef">readIORef</a>. readIORef will take our IORef and just made it a value in the IO monad meaning we can simply use "&lt;-" to emit the value.<br /><br /><script src="https://gist.github.com/4689688.js"></script> This all pretty straight forward. Seeing this Counter run from GHCI is pretty straight forward.<br /><br /><pre>λ&gt; c &lt;- makeCounter 1<br />λ&gt; showCounter c<br />1<br />λ&gt; incCounter 1 c<br />λ&gt; showCounter c<br />2<br /></pre><br />There you have it - mutable state with IORef.<br /><br /></div></div>
<h2>Comments</h2>
<div class='comments'>
</div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2013/01/29/write-yourself-a-scheme-in-48-hours/">
        Write yourself a Scheme in 48 Hours
      </a>
    </h1>

    <span class="post-date">29 Jan 2013</span>

    <h1>Write yourself a Scheme in 48 Hours</h1>
<div class='post'>
A small bookmark to myself, wikibooks has an import of Johnathan Tang's <a href="http://jonathan.tang.name/files/scheme_in_48/tutorial/overview.html">Write Yourself a Scheme in 48 Hours</a> that I've come across.<br /><br /><a href="http://en.wikibooks.org/wiki/Write_Yourself_a_Scheme_in_48_Hours">http://en.wikibooks.org/wiki/Write_Yourself_a_Scheme_in_48_Hours</a><br /><br />Looks quite good if you've already gone through the language cruft that all of the other tutorials put you through first.</div>
<h2>Comments</h2>
<div class='comments'>
</div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2013/01/29/making-a-big-math-library-part-2/">
        Making a Big Math Library (Part 2)
      </a>
    </h1>

    <span class="post-date">29 Jan 2013</span>

    <h1>Making a Big Math Library (Part 2)</h1>
<div class='post'>
<h3>Introduction</h3><div>In the <a href="http://cogsandlevers.blogspot.com.au/2013/01/making-big-math-library.html">previous post</a>, we had setup a basic array data type to act as a very big number. We implemented an initialise, increment and decrement function. Today we'll extend on this library by adding some zero testing. It is of interest to us when our numbers are zero and when they aren't.</div><div><br /></div><h3>Scanning our number</h3><div>The plan of attack is to use a scan string quad-word (scasq). We're going to enumerate our array, testing each block for zero. If we make it to the end of the array, we have a zero number. If our scanning got interrupted by a non-zero number, our overall number couldn't possibly be zero.</div><div><br /></div><div>Here's the code.</div><div><br /><script src="https://gist.github.com/4660728.js"></script></div><div></div>Now that we've got this function, we can wrap it up with a print so we can visually see if a number is zero or not. This will also give you basic usage of the function above.<br /><script src="https://gist.github.com/4660742.js"></script> <br /><br /><h3>In action</h3><div>Now that we've got a little helper function to wrap up our is-zeroness and reporting on this to the console, we're free to test it out as follows.</div><div><br /><script src="https://gist.github.com/4660760.js"></script></div><div><br />To which we end up with a result looking like this.<br /><br /><pre>➜  bigmath  ./bigmath<br />The number was zeroThe number was not zero                               <br /></pre><br />As expected. Initially the number was zero, after incrementation is was not.<br /><br />There's some basic logic testing for your big number.</div></div>
<h2>Comments</h2>
<div class='comments'>
</div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2013/01/28/monads/">
        Monads
      </a>
    </h1>

    <span class="post-date">28 Jan 2013</span>

    <h1>Monads</h1>
<div class='post'>
<h3>Introduction</h3><div>Following on from my previous posts about <a href="http://cogsandlevers.blogspot.com.au/2013/01/functors-in-haskell.html">functors</a>, <a href="http://cogsandlevers.blogspot.com.au/2013/01/applicative-functors-in-haskell.html">applicative functors</a> and <a href="http://cogsandlevers.blogspot.com.au/2013/01/applying-applicative.html">applying applicative</a>&nbsp;it would only be natural for me to post a follow up on the topic of Monads. Monads take shape very similarly to applicative functors so for this post to make sense, I suggest you read the previous articles so that you have a chance to follow along.</div><div><br /></div><h3>What is a Monad?</h3><div>At a code level, a Monad is a type that is an instance of the <a href="http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#t:Monad">Monad</a> type class. At a concept level a Monad allows you to provide a function that is context-unaware to operate over values that are wrapped in a context. Immediately, you'd think that this is weaker functionality that what was defined for applicative functors - and you'd be right in thinking so, but Monads do provide a very natural way to write code against our types.</div><div><br /></div><div>Here is the type definition for a Monad.</div><div><br /><script src="https://gist.github.com/4654705.js"></script></div><div><br />Moving through all of the defined functions, you first see "return". "return" is the same as "pure" which we defined when making an applicative functor. "return"'s role in this type is to lift a value into a context. The next function you see is "&gt;&gt;=" which is pronounced "bind". This is the major difference right here. The "bind" function is what takes a value wrapped in a context <b>"m a" </b>and takes a function with a parameter of <b>"a" </b>returning a wrapped b as <b>"m b"</b>, with the function returning a b in a context "<b>m b"</b>.<br /><br />The remaining two operations are rarely delved into as their default implementations suffice majority of scenarios.<br /><br /><h3>Laws</h3><div>There are some laws that need to be abided by when implementing Monads.</div><div><br /></div><div>Left Identity suggests that&nbsp;</div><div><br /></div><div><pre>x &gt;&gt;= f is the same thing as f x&nbsp;</pre><br />Right Identity suggests that<br /><br /><pre>m &gt;&gt;= return is the same as m</pre><br />Associativity suggests that<br /><br /><pre>(m &gt;&gt;= f) &gt;&gt;= g is the same as m &gt;&gt;= (\x -&gt; f x &gt;&gt;= g)</pre><br />Such that it shouldn't matter how these calls are nested together.</div><h3>Custom context</h3><div>Applying this knowledge to our rather useless example "CustomContext" discussed <a href="http://cogsandlevers.blogspot.com.au/2013/01/applying-applicative.html">here</a>, we can make this type a monad with the following definition.</div><div><br /><script src="https://gist.github.com/4654745.js"></script></div><div><br /></div>Ok, so - as prophesied "return" is doing the same thing as "pure" did for us - it's just lifting a plain value into our context. "&gt;&gt;=" or "bind" on the other hand is taking the value out of its context and applying a function to it.<br /><br />We can check out our bind implementation in action with the following simple examples.<br /><br /><pre>λ&gt; CustomContext 3 &gt;&gt;= \x -&gt; return (x + 1)<br />CustomContext 4<br />λ&gt; CustomContext "Hello" &gt;&gt;= \x -&gt; return (x ++ " World!")<br />CustomContext "Hello World!"<br /></pre><br />Our value is having a function applied to it. Values are getting de-contexted, worked-on than re-contexted. Pretty straight forward.<br /><br />To show you how "&gt;&gt;=" can work for us, I've created a function that will accumulate even numbers as they are received into it. If an odd number is encountered, the accumulated total get wiped back to zero until conditions are met to have another two consecutive calls with even numbers.<br /><br />Here's how the function looks.<br /><br /><script src="https://gist.github.com/4654909.js"></script> <br />Using guards, we filter out odd numbers sending the result back to zero otherwise we continue to accumulate. Note how the inputs are just plain integers but the output is an integer wrapped in one of our CustomContext types. With the use of "&gt;&gt;=" the following calls are possible.<br /><br /><pre>λ&gt; accumEven 0 2<br />CustomContext 2<br />λ&gt; accumEven 0 2 &gt;&gt;= accumEven 4<br />CustomContext 6<br />λ&gt; accumEven 0 2 &gt;&gt;= accumEven 4 &gt;&gt;= accumEven 7<br />CustomContext 13<br /></pre><br />First of all, we're freely using wrapped and un-wrapped contexts thanks to that bind operator. More interestingly (and demonstrative to our purposes here), the last example appears to be in error, but it's really not. Think about it this way.<br /><br /><pre>accumEven 0 2 = 2<br />accumEven 4 2 = 6<br />accumEven 6 7 = 13<br /></pre><br />So you can see here that the next sub-sequent call to "accumEven" would finish with a 0 (zero) value as the 13 would be carried onto the next call and would be tested for evenness. Even if this isn't the best example, it still demonstrates how bind is sending information between the calls.<br /><br /><h3>do Notation</h3><div>Another nicety when working with Monads is "do" notation. "do" notation allows you to clean up a lot of the boilerplate that builds up around the functionality you write when working with monadic values. Here's a very simple function that builds a CustomContext from two other CustomContexts by adding them.</div><div><br /><script src="https://gist.github.com/4655091.js"></script></div><div><br /></div>You can see how things start to get a bit gnarly once you chain more calls together. Using "do" notation, this gets cleaned up pretty well. The above can be re-written like so.<br /><br /><script src="https://gist.github.com/4655121.js"></script> <br />That's so much easier to read! There's "do" notation at work for you, anyway.<br /><br />Well, that's all there is for Monads right now. As soon as I try something useful with them, I'll post a follow-up article of Monads in Application.<br /><br /></div></div>
<h2>Comments</h2>
<div class='comments'>
</div>

  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page15">Older</a>
  
  
    
      <a class="pagination-item newer" href="/page13">Newer</a>
    
  
</div>
      </div>
    </div>

  </body>
</html>
