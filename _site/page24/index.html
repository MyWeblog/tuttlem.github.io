<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Cogs and Levers &middot; A blog full of technical stuff
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>A place for thoughts, ideas, tutorials and bookmarks. My brain can only hold so much, you know.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    

    
    
      
        
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    

    <a class="sidebar-nav-item" href="https://github.com/tuttlem/tuttlem.github.io">GitHub</a>
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2014. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <label for="sidebar-checkbox" class="sidebar-toggle"></label>

          <h3 class="masthead-title">
            <a href="/" title="Home">Cogs and Levers</a>
            <small>A blog full of technical stuff</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2013/01/04/picking-your-smart-pointers/">
        Picking your Smart Pointers
      </a>
    </h1>

    <span class="post-date">04 Jan 2013</span>

    <h1>Picking your Smart Pointers</h1>
<div class='post'>
<h3>Introduction</h3><div>I wanted to do a quick write up on the <a href="http://www.boost.org/">Boost library's</a>&nbsp;<a href="http://www.boost.org/doc/libs/1_52_0/libs/smart_ptr/smart_ptr.htm">Smart Pointers</a>&nbsp;and when they should and shouldn't be used. I'd hope to use this post in future (if the knowledge doesn't stick in my head) as a rough guide when finding the right tool for the job.</div><div><br /></div><div>For the uninitiated, I strongly advise that you go through the <a href="http://www.boost.org/doc/libs/1_52_0/libs/smart_ptr/smart_ptr.htm">smart pointer</a>&nbsp;documentation on the Boost website as it's a real eye-opener as to just how hands-off you can now be with dynamic memory allocation in C++ (these days).</div><div><br /></div><h3>Why use Smart Pointers?</h3><div>Smart pointers will help you manage the lifetime of your objects. It will force you to think about the ownership of these pointers and who's currently "in-charge" in some cases. They will allow you to think in terms of observation of objects so that you don't disturb the ownership of a resource and they just generally make your code cleaner, easier to maintain and read.</div><div><br /></div><div><br /></div><h3>How can I start using Smart Pointers?</h3><div><a href="http://www.boost.org/users/download/">Get Boost!</a>&nbsp;That's going to be the best way. Dive right in, take a look at samples, set things up, blow them up - be a scientist about it!</div><div><br /></div><div>Anyway, enough of this! On to the pointers.</div><div><br /></div><h3><a href="http://www.boost.org/doc/libs/1_52_0/libs/smart_ptr/scoped_ptr.htm">scoped_ptr</a>&nbsp;&amp; <a href="http://www.boost.org/doc/libs/1_52_0/libs/smart_ptr/scoped_array.htm">scoped_array</a></h3><div>scoped_ptr is all about ensuring that the pointer that you're working with is the ultimate owner of the resource that it points to. There's no facility within this pointer type to transfer the ownership of the inner resource elsewhere. With all of this in mind, scoped_ptr ensures that the resource that is under ownership will be destroyed properly once the pointer has dropped out of scope.</div><div><br /></div><div>scoped_ptr is a very lightweight resource. It's by no means going to harm the performance or size of your application.</div><div><br /></div><div>scoped_array will perform the same service as scoped_ptr does, it's just that scoped_array will work on array types (as the name suggests).&nbsp;</div><div><br /></div><h3><a href="http://www.boost.org/doc/libs/1_52_0/libs/smart_ptr/shared_ptr.htm">shared_ptr</a> &amp; <a href="http://www.boost.org/doc/libs/1_52_0/libs/smart_ptr/shared_array.htm">shared_array</a></h3><div>shared_ptr is all about reference counting. They will internally manage the reference count that they have and govern the managed resource's lifespan based on this. The clear advantage that they have over the scoped_ptr and scoped_array counterparts is their ability to be shared between multiple owner so that those owners can maintain their interest in the object by "hanging around".&nbsp;</div><div><br /></div><div>The true power of this class of pointer is when you don't know when to delete the underlying resource. As long as someone is referencing you, you'll stay alive.</div><div><br /></div><div>shared_array will perform the same service as shared_ptr does, it's just that shared_array will work on array types (deja vu anyone?)</div><div><br /></div><h3><a href="http://www.boost.org/doc/libs/1_52_0/libs/smart_ptr/intrusive_ptr.html">intrusive_ptr</a></h3><div>The intrusive_ptr is another reference counting pointer only is allows you to provide your own mechanism for performing the reference counting. This means if you have an existing codebase that does all of this work for you, all you need to do is provide it to an intrusive_ptr. intrusive_ptr also allows for native usage of the "this" keyword.</div><div><br /></div><h3><a href="http://www.boost.org/doc/libs/1_52_0/libs/smart_ptr/weak_ptr.htm">weak_ptr</a></h3><div>A weak_ptr just performs observation on a shared_ptr without getting its hands into ownership. It's used purely at an observation capacity.</div><div><br /></div><h3>Conclusion</h3><div>That's it for a brief smart pointer analysis. Hopefully these tid-bits will help you decide which pointer fits your problem best.</div><div><br /></div><div><br /></div></div>
<h2>Comments</h2>
<div class='comments'>
</div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2013/01/03/a-brief-mapreduce-tutorial-for-mongodb/">
        A brief MapReduce tutorial for MongoDB
      </a>
    </h1>

    <span class="post-date">03 Jan 2013</span>

    <h1>A brief MapReduce tutorial for MongoDB</h1>
<div class='post'>
<h3>Introduction</h3><div>This is just a short tutorial on using the <a href="http://www.mongodb.org/display/DOCS/MapReduce">MapReduce</a> operation from within the <a href="http://www.mongodb.org/">MongoDB</a> environment.</div><div><br /></div><h3>What is it and how does it work?</h3><div>MapReduce is a database operation. Its intended for performing higher-level (or more complex) aggregation tasks across huge data stores. You supply it with two functions, a map function and a reduce function and it will supply you with the aggregated result.</div><div><br /></div><div>As it's defined from the MongoDB documentation, the operation takes the following form:</div><div><br /><pre class="brush:js">db.collection.mapReduce(<br />                         &lt;mapfunction&gt;,<br />                         &lt;reducefunction&gt;,<br />                         {<br />                           out: &lt;collection&gt;,<br />                           query: &lt;document&gt;,<br />                           sort: &lt;document&gt;,<br />                           limit: &lt;number&gt;,<br />                           finalize: &lt;function&gt;,<br />                           scope: &lt;document&gt;,<br />                           jsMode: &lt;boolean&gt;,<br />                           verbose: &lt;boolean&gt;<br />                         }<br />                       )</pre></div><div><br />You can immediately see the first two parameters to this operation as the map function and the reduce function. The remaining parameter is focused on the delivery of the result back to you.<br /><br /><h3>The Map Function</h3></div><div>The map function is responsible for defining the data that you want to work with. For instance, if you're interested in accumulating the sum of all products sold by their category you will want to return both the amount sold per line item as well as the product's category.</div><div><br /><pre class="brush:js">var mapFunction = function() {<br />    emit(this.category, this.price);<br />};</pre></div><div><br />Note the use of the emit function. Its use tells the MapReduce operation that the key for this process will be "category" and the value will be "price". The value part of the emit function can also take form of a javascript object itself should you need to perform multiple aggregations across the same data set.<br /><br /><pre class="brush:js">var mapFunction = function() {<br />    emit(this.category, { price: this.price, count: 1 });<br />};</pre><br />This particular map function gives us a count of 1 per result that comes out so we would be able to not only sum the price but find out how many items made up the sum as well.<br /><br /><h3>The Reduce Function</h3></div><div>The reduce function is responsible for performing the aggregation on the data emitted by the map function. It is passed the key-values emitted by the map function as parameters to it. Performing the reduce function to get the sum of all prices and the number of items making up the sum total would look like this.</div><div><br /><pre class="brush:js">var reduceFunction = function(key, values) {<br />    outValue = { total: 0, count: 0 };<br />    <br />    // aggregate all of the values for this key<br />    for (var i = 0; i &lt; values.length; i ++) {<br />        outValue.total += values[i].price;<br />        outValue.count += values[i].count; <br />    }<br /><br />    return outValue;<br />};</pre></div><div><br />All of the "magic" happens via-javascript. Pretty easy really.<br /><br /><h3>Getting a result</h3></div><div>Putting your map and reduce function together for the operation ends up looking like this (for a simple scenario).</div><div><br /><pre class="brush:js">var res = db.sales.mapReduce(<br />    mapFunction, <br />    reduceFunction, <br />    { <br />        out: "result" <br />    }<br />);</pre></div><div><br />This will get the process underway against the database. Once it's finished doing the hard-yards, then you can start basing your aggregation reports off of the "res" variable that we built just above by doing the following.<br /><br /><pre class="brush:js">db[res.result].find();</pre><br />This is only a "scratch-the-surface" - "know enough to be dangerous" type write-up. MapReduce is a complex and powerful tool that you should be reading the official documentation about if you want to achieve ninja-like status.<br /><br /><br /></div></div>
<h2>Comments</h2>
<div class='comments'>
</div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2013/01/02/opengl-glut-haskell/">
        OpenGL, GLUT & Haskell
      </a>
    </h1>

    <span class="post-date">02 Jan 2013</span>

    <h1>OpenGL, GLUT & Haskell</h1>
<div class='post'>
<h3>Introduction</h3><div>We're into some of the real good stuff here. One of my favourite topics in computer programming is graphics (2d and 3d). In this post, I get to make a start on some fun stuff and learn some Haskell at the same time.</div><div><br /></div><div>We're going to open an OpenGL window, clear the back buffer out and flip.</div><div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-P3UGaGgWX0c/UOQmSYep7wI/AAAAAAAAAkQ/Bfl8-egapPc/s1600/Screen+Shot+2013-01-02+at+10.20.45+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://1.bp.blogspot.com/-P3UGaGgWX0c/UOQmSYep7wI/AAAAAAAAAkQ/Bfl8-egapPc/s400/Screen+Shot+2013-01-02+at+10.20.45+PM.png" width="378" /></a></div><br /></div><h3>The code</h3><div><br /><script src="https://gist.github.com/4434168.js"></script></div><br />Ok, ok, fair enough - this is almost a direct-rip from the <a href="http://www.haskell.org/haskellwiki/OpenGLTutorial1">Haskell Wiki</a>, I'm not claiming it as my code. It's more of a bookmark as a good foot-hold in the OpenGL-Haskell marriage!<br /><br /><h3>Compilation</h3><div>Getting your application compiled is cake, just make sure you specify GLUT as a package.<br /><br /><pre>$ ghc -package GLUT Ogl.hs -o Ogl</pre></div><br /><br />That's what it's all about!</div>
<h2>Comments</h2>
<div class='comments'>
</div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2013/01/02/learn-you-a-haskell-brisbane-study-group/">
        Learn you a Haskell Brisbane Study Group
      </a>
    </h1>

    <span class="post-date">02 Jan 2013</span>

    <h1>Learn you a Haskell Brisbane Study Group</h1>
<div class='post'>
As a bit of a bookmark to myself, I wanted to make mention of a study group that an <a href="http://morenews.blogspot.com.au/">old colleague</a>&nbsp;had brought to my attention.<br /><br />The <a href="https://github.com/learnhaskell-brisbane/learn/wiki">wiki</a>&nbsp;that has been put up for this project has been a great source of home-work as I've gone through the book. I haven't yet made it to the end of the book but am working on it. It's been important for me to have some home work to do on this topic as I don't write Haskell professionally. Without something flexing my Haskell muscles, the knowledge tends to go on holiday rather quickly.<br /><br />The <a href="https://github.com/learnhaskell-brisbane/learn">learn repository</a>&nbsp;has all of the source code and documents for the course.<br /><br /><br /></div>
<h2>Comments</h2>
<div class='comments'>
</div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2013/01/02/derived-instances-for-types-in-haskell/">
        Derived Instances for Types in Haskell
      </a>
    </h1>

    <span class="post-date">02 Jan 2013</span>

    <h1>Derived Instances for Types in Haskell</h1>
<div class='post'>
<h3>Introduction</h3>When constructing your own types in Haskell, you can make your type support a particular&nbsp;behavior&nbsp;by making it an instance of the&nbsp;behavioral&nbsp;type class required. I'll walk through each of these derivable&nbsp;behaviours and how they can help.<br /><br /><h3><a href="http://www.haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Eq">Eq</a></h3>Eq gives your type a sense of equality amongst values of the same type. It allows you to use the "==" operator as it was intended, returning you a boolean.<br /><br /><script src="https://gist.github.com/4433571.js"></script> <br />From now on, the "==" operator will do a comparison on the contents of the three strings in the Employee record for us.<br /><br /><h3><a href="http://www.haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Show">Show</a></h3>In my personal experience when defining types, I would be out of my mind not to make them derive "Show". "Show" allows a value of your type to be put into string format - very useful for debug situations.<br /><br /><script src="https://gist.github.com/4433617.js"></script> Just for the printing value, you can see how "Show" is worth its weight in gold.<br /><br /><h3><a href="http://www.haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Read">Read</a></h3>"Read" provides the reverse-service of what "Show" does. You'll be able to take a type in its serialized format and re-construct a type from it. Again, rather useful in debug situations.<br /><br /><script src="https://gist.github.com/4433642.js"></script> I've also used this to do user-input rather cheaply. Probably not quite a "production solution" though having your users enter type data directly.<br /><br /><h3><a href="http://www.haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Ord">Ord</a></h3>"Ord" gives your value order. Once you apply "Ord" you can sort or use operators like "&gt;", "&lt;", "&gt;=", &nbsp;"&lt;=".<br /><br /><script src="https://gist.github.com/4433758.js"></script> Quite useful for when you need to do these sorts of comparisons.<br /><br /><h3><a href="http://www.haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Bounded">Bounded</a></h3><div>"Bounded" will give your type a sense of the lowest and highest values achievable. You'll be able to ask questions of the type to see what these corresponding values are.</div><div><br /></div><div><br /></div><script src="https://gist.github.com/4433847.js"></script> <br /><h3><a href="http://www.haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Enum">Enum</a></h3><div>"Enum" will give your type a sense of the predecessor and successor values. This is most important when dealing with ranges in using your type. Take a look at the following deck assembly. Without "Bounded" the list comprehensions would not be possible and this code would be a lot more verbose.</div><br /><script src="https://gist.github.com/4433859.js"></script> That's derived instances for you anyway. They're a great help when constructing your own types in Haskell.<br /><br />I think an important follow up to this blog post is being able to use these classes in conjunction with the <a href="http://www.haskell.org/haskellwiki/Keywords#instance">instance</a>&nbsp;keyword so that we can supply the implementation to the definition.<br /><br />Using the card example, we could supply an Eq and Show instance as follows.<br /><br /><script src="https://gist.github.com/4438758.js"></script> <br />You can see here that it's quite counter-productive to supply our own Eq implementation, but if we did have some funky rules on how we wanted equality operators to work it would be worth it. In the show implementation, I've tried to make the suits read a little more humanly. Around the card table, you would normally hear someone say "Do you have a 2 of clubs?" rather than "Do you have a 2 of club?". The trailing "s" has been added in the show implementation. Neat.<br /><br /><h3><a href="http://www.haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#t:Functor">Functor</a></h3><div>"Functor" is applied to wrapper types. You'll commonly see examples used with Maybe. You'll use "Functor" when ever you need to supply an <a href="http://www.haskell.org/ghc/docs/latest/html/libraries/base/Prelude.html#v:fmap">fmap</a>&nbsp;implementation. Here is a simple example that creates a wrapper data type.</div><div><br /><script src="https://gist.github.com/4440349.js"></script></div><div><br /></div><div><br /></div><div>"Functor" is useful for types that contain something, Lists, Maps, etc.</div></div>
<h2>Comments</h2>
<div class='comments'>
</div>

  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page25">Older</a>
  
  
    
      <a class="pagination-item newer" href="/page23">Newer</a>
    
  
</div>
      </div>
    </div>

  </body>
</html>
