<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Cogs and Levers &middot; A blog full of technical stuff
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>A place for thoughts, ideas, tutorials and bookmarks. My brain can only hold so much, you know.</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    

    
    
      
        
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    

    <a class="sidebar-nav-item" href="https://github.com/tuttlem/tuttlem.github.io">GitHub</a>
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2014. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <label for="sidebar-checkbox" class="sidebar-toggle"></label>

          <h3 class="masthead-title">
            <a href="/" title="Home">Cogs and Levers</a>
            <small>A blog full of technical stuff</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2012/12/08/function-pointers-the-macgyver-of-c/">
        Function Pointers, the MacGyver of C
      </a>
    </h1>

    <span class="post-date">08 Dec 2012</span>

    <h1>Function Pointers, the MacGyver of C</h1>
<div class='post'>
<h3>Introduction</h3><div>It's a very well studied topic in the C field. Many people have written tutorials on how to use function pointers and what they are. <a href="http://www.newty.de/fpt/fpt.html">The function pointer tutorial</a> is always a good read for the uninitiated or seasoned professional who's function pointer theory is a little rusty.</div><div><br /></div><div>This write up isn't going to try and fill the shoes of the basic-square-1-hello-world style tutorial. I just wanted to talk about how I've used them to better a piece of code and make a system a bit more extensible overall.</div><div><br /></div><h3>What are they?</h3><div>Like any data pointer a function pointer is an address. It's an address that will point to the entry-point of some code. It's that simple. The complexity comes into the argument when you start to add C syntax. C likes to be very descriptive with the data that you're feeding functions and function parameters are no exception.</div><div><br /><script src="https://gist.github.com/4238320.js?file=gistfile1.c"></script></div><div><br /></div><div><br /></div><div>Ok, simple example time over. It's onto what this article is really about.<br /><br /><h3>Problem description</h3></div><div>I have a game that has a few game states. They look like this:</div><div><ul><li>Introduction credits</li><li>Game title</li><li>Menu</li><li>Game play</li><li>Game over</li><li>High score board</li></ul><div>Each of these states all have functionality that they need to accomplish. The basic specification for a game state goes as follows:</div></div><div><ul><li>Needs to be able to be initialized</li><li>Needs to be able to have its resources freed (tear down)</li><li>Needs to be able to update its internal logic</li><li>Needs to be able to render its internal state&nbsp;</li><li>Needs to be able to respond to events (keyboard, etc)</li></ul><div>Good. We've established that we have a set of game states and they all attract a set of actions that we'd like them to perform.</div></div><div><br /><h3>Getting down to it</h3><br /></div><div>So, let's define the actions first (as function pointers) and we can then fill in the implementation later:</div><div><br /><script src="https://gist.github.com/4238398.js?file=gistfile1.c"></script></div><div><br /></div><div><br /></div><div>Slightly different from above is the use of the "typedef" keyword. This allows us to define these function pointers as types so that we can treat them just as we do any other type. These types that we've defined are the outline to what we need. We still have the colour in, but we've got a framework ready to go.<br /><br />Lets define our function pointer variables using the types we defined above.<br /><br /><script src="https://gist.github.com/4238417.js?file=gistfile1.c"></script> <br />Simple enough. Now that we have these variables define (close-by to our game loop), we can write a game loop that will look a little something like this:<br /><br /><script src="https://gist.github.com/4238422.js?file=gistfile1.c"></script> <br /><br />This is psuedo code really. There's a whole heap of infrastructure that you'll need in order to make this work.<br /><br />You can see that only 3 of the functions we require are being are being used at the moment. We still need to get the init and teardown involved. The game module also needs a way to shift between game states.<br /><br />Thankfully, both of these functions come together in the one function:<br /><br /><script src="https://gist.github.com/4238435.js?file=gistfile1.c"></script> <br />So, this function tearsdown the existing game state (if we have a state), and initializes if we initialize to a valid state. Easy!!<br /><br />Well, this has been just one possible use for function pointers. You can do so much, much more with them, but I thought I'd share my use of them here!<br /><br /></div></div>
<h2>Comments</h2>
<div class='comments'>
</div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2012/12/07/macro-ing-yourself-out-of-the-boilerplate/">
        Macro-ing yourself out of the boilerplate
      </a>
    </h1>

    <span class="post-date">07 Dec 2012</span>

    <h1>Macro-ing yourself out of the boilerplate</h1>
<div class='post'>
Just working on a "build your own clone" style tutorial and going over some older code here, I thought it'd be interesting to note some funky work I'd done with macros.&nbsp;When you're working with 2-d array style states you get very good a writing for-loops over and over and over and ...<br /><br />So, thinking about this in a very generic sense - take a look at this macro<br /><br /><script src="https://gist.github.com/4230103.js?file=gistfile1.c"></script> <br />Working your way through the "enum_field_blocks" macro here, the parameters are:<br /><br /><ul><li>A horizontal axis iterator "x"</li><li>A vertical axis iterator "y"</li><li>A memory location (array index) iterator "o"</li><li>and "fn"</li></ul><div>So, what's "fn"? "fn" here allows the developer to specify what they want to execute inside the nested for loops:</div><div><br /><script src="https://gist.github.com/4230130.js?file=gistfile1.c"></script> <br /></div><div>If you're thinking "why didn't he just use <a href="http://www.kernel.org/doc/man-pages/online/pages/man3/memset.3.html">memset</a>&nbsp;to set all of the items in this array to NULL" - you've missed the point. The example is quite a bad one, I agree, but it does demonstrate that you can write any code that you'd like and have it execute for every item in the specific array cutting down on boilerplate that you have to write (just get the C pre-processor to do it for you).<br /><br />Super.</div></div>
<h2>Comments</h2>
<div class='comments'>
</div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2012/12/04/assembly-language-links/">
        Assembly language links
      </a>
    </h1>

    <span class="post-date">04 Dec 2012</span>

    <h1>Assembly language links</h1>
<div class='post'>
See, people care(ed like years ago, dude)!<br /><br />Here's some interesting links for the world of assembly language:<br /><br /><a href="http://www.microsoft.com/msj/0298/hood0298.aspx">MSJ - Under the Hood (February 1998)</a><br /><br /><a href="http://www.microsoft.com/msj/0698/hood0698.aspx">MSJ - Under the Hood (June 1998)</a><br /><br /><a href="http://www.agner.org/optimize/">Software Optimisation Resources</a><br /><br /><br /></div>
<h2>Comments</h2>
<div class='comments'>
</div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2012/12/03/windows-development-with-masm32-part-6/">
        Windows Development with MASM32 (part 6)
      </a>
    </h1>

    <span class="post-date">03 Dec 2012</span>

    <h1>Windows Development with MASM32 (part 6)</h1>
<div class='post'>
Multiple document interface</div>
<h2>Comments</h2>
<div class='comments'>
</div>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2012/12/03/sdl-you-can-use-part-5/">
        SDL you can use (part 5)
      </a>
    </h1>

    <span class="post-date">03 Dec 2012</span>

    <h1>SDL you can use (part 5)</h1>
<div class='post'>
<h3>Introduction</h3><div>What good is a game if you can't influence any of the objects? I mean, people go into battle these days armed with a keyboard, mouse and/or joystick to engage in wars never before seen.</div><div><br /></div><div>In this tutorial, I'll show you how to enable your users with such weapons of mass control (see what I did there?) ... <i>lame</i></div><div><i><br /></i></div><h3>Interesting events</h3><div>It's all in the event loop. When the application receives input from a device, it'll let you know through the evening system.</div><div><br /></div><div>Here's some code - not much in the way of explanations. It's a pretty simple construct.</div><div><br /><script src="https://gist.github.com/4194490.js?file=gistfile1.c"></script></div><div><br /><br /><br />So, it's all pretty simple to respond to events. Mouse, Keyboard and Joystick motion all make up parts of the eventing system. Check out <a href="http://www.libsdl.org/docs/html/sdlevent.html">SDL_Event</a>&nbsp;for further information. It includes everything you need.<br /><br />Only a quick one!</div></div>
<h2>Comments</h2>
<div class='comments'>
</div>

  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page35">Older</a>
  
  
    
      <a class="pagination-item newer" href="/page33">Newer</a>
    
  
</div>
      </div>
    </div>

  </body>
</html>
